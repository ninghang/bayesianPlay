<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>BFilt: An Ornstien-Uhlenbeck process</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="page2">An Ornstien-Uhlenbeck process </a></h1>This example illustrate how to use BFilt for continuous-discrete filtering. Here the state is described by the following linear stochastic differential equation : <p class="formulaDsp">
<img class="formulaDsp" alt="\[ d \left ( \begin{array}{c} x \\ \dot{x} \\ \end{array} \right ) = \left ( \begin{array}{cc} 0 &amp; 1 \\ -w_0^2 &amp; -\gamma \\ \end{array} \right ) \left ( \begin{array}{c} x \\ \dot{x} \\ \end{array} \right ) dt + \left( \begin{array}{c} 0 \\ b \\ \end{array} \right ) dt + \left ( \begin{array}{c} 0 \\ g \\ \end{array} \right ) dW(t) \]" src="form_33.png">
<p>
<p>
Where W(t) is a Wiener process,<p>
<img class="formulaInl" alt="$ w_0^2=16, \gamma = 2, b=8, g=2$" src="form_34.png"> and the initials conditions <img class="formulaInl" alt="$ X_0=(0,0) $" src="form_35.png"> and <img class="formulaInl" alt="$ R_0=diag[0,3]$" src="form_36.png">.<p>
The state <img class="formulaInl" alt="$ X(t) = (x,\dot{x})(t)$" src="form_37.png"> is then observed by the output <img class="formulaInl" alt="$ Y_k \in \mathcal{R} $" src="form_27.png"> : <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Y_k = x(t_k) + V_k \]" src="form_38.png">
<p>
<p>
at discrete time <img class="formulaInl" alt="$ t_k $" src="form_39.png">. The sampling period <img class="formulaInl" alt="$ T_s = t_{k-1} - t_k = 0.2s $" src="form_40.png"> and <img class="formulaInl" alt="$ V_k \sim \mathcal{N}(0,0.001) $" src="form_41.png">. In fact only the position is observed. First this model must be define as a sister class of linear time invariant continuous discrete models (<a class="el" href="class_linear___c_d___model.html" title="Linear continuous discrete model class of the form dx = AX dt + Bdt + CdW Y_k = HX(t_k)...">Linear_CD_Model</a>). <div class="fragment"><pre class="fragment"><span class="preprocessor">#ifndef __ORNSTEIN_UHL__</span>
<span class="preprocessor"></span><span class="preprocessor">#define __ORNSTEIN_UHL__</span>
<span class="preprocessor"></span>
<span class="preprocessor">#include &lt;bfilt/gaussian_model.h&gt;</span>

<span class="keyword">class </span>Ornstein_Uhlenbeck_Model : <span class="keyword">public</span> <a class="code" href="class_linear___c_d___model.html" title="Linear continuous discrete model class of the form dx = AX dt + Bdt + CdW Y_k = HX(t_k)...">Linear_CD_Model</a>
{
<span class="keyword">public</span> :
      <span class="keywordtype">double</span> gamma;
      <span class="keywordtype">double</span> w;
      <span class="keywordtype">double</span> b;
      <span class="keywordtype">double</span> g;
      Ornstein_Uhlenbeck_Model(<span class="keywordtype">void</span>);


};

<span class="preprocessor">#endif</span>
</pre></div> The <a class="el" href="class_linear___c_d___model.html" title="Linear continuous discrete model class of the form dx = AX dt + Bdt + CdW Y_k = HX(t_k)...">Linear_CD_Model</a> are implemented in the following form : <p class="formulaDsp">
<img class="formulaDsp" alt="\[ dX(t) = A X(t)dt + Bdt + C dW(t) \]" src="form_42.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Y_k = H X(t_k) + h + V_k \]" src="form_43.png">
<p>
 The constructor of Ornstein_Uhlenbeck_Model is then : <div class="fragment"><pre class="fragment"><span class="preprocessor">#include "ornstein_uhlenbeck.h"</span>

Ornstein_Uhlenbeck_Model::Ornstein_Uhlenbeck_Model(<span class="keywordtype">void</span>)
{
      <span class="comment">// parameters</span>
      w = 4.;
      gamma = 2.;
      b = 8.;
      g = 2.;

      <span class="comment">// Matrices of the state equation</span>
      A.resize(2,2);
      A(0,0) = 0.;
      A(0,1) = 1.;
      A(1,0) = - (w*w);
      A(1,1) = -gamma;
      
      
      B.resize(2);
      B(0) = 0;
      B(1) = b;

      C.resize(2,1);
      C(0,0)=0.;
      C(1,0)=g;

      <span class="comment">// Matrices of the Observation equation</span>
      H.resize(1,2);
      H(0,0) = 1.;
      H(0,1) = 0.;

      h.resize(2);
      h.zero();

      Qw.resize(1);
      Qw.identity();
      Qw*=0.01;

      Qv.resize(1);
      Qv(0,0) = 0.001;

      <span class="comment">// Sampling period</span>
      Ts = 0.2;

      <span class="comment">// Initial conditions</span>
      R0.resize(2);
      R0.zero();
      R0(0,0)=0.;
      R0(1,1)=3.;
      
      X0.resize(2);
      X0.zero();
            

}
</pre></div><h2><a class="anchor" name="sec2">
The main program</a></h2>
In the main program, the model will be first simulted with a specific simulator for <a class="el" href="class_linear___c_d___model.html" title="Linear continuous discrete model class of the form dx = AX dt + Bdt + CdW Y_k = HX(t_k)...">Linear_CD_Model</a> (<a class="el" href="class_l_t_i___c_d___simulator.html">LTI_CD_Simulator</a>). The simulated output sequence <img class="formulaInl" alt="$ y_{0:N}$" src="form_11.png"> is given to the input of the continuous-discrete kalman filter (<a class="el" href="class_c_d___filter.html" title="Abstract class of continuous-discrete filters.">CD_Filter</a>) to estimate the state trajectory <img class="formulaInl" alt="$ \hat{X}_{0:k} $" src="form_32.png">. First, all this objects are declared :<p>
 <div class="fragment"><pre class="fragment"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
{
      Ornstein_Uhlenbeck_Model model; <span class="comment">// The model</span>

      <a class="code" href="class_l_t_i___c_d___simulator.html">LTI_CD_Simulator</a> sim(&amp;model);   <span class="comment">// The simulator</span>
      
      <a class="code" href="class_c_d___kalman.html" title="The continuous-discrete kalman filter.">CD_Kalman</a>  filter(&amp;model);      <span class="comment">// The Kalman filter      </span>
</pre></div><p>
Then 10 second are simulated : <div class="fragment"><pre class="fragment">      sim.Simulate(10.);
</pre></div> The kalman filter is apply on the output sequence : <div class="fragment"><pre class="fragment"></pre></div> You can save the simulated sequences : <div class="fragment"><pre class="fragment">      sim.Save_Y(<span class="stringliteral">"output.dat"</span>);
      sim.Save_X(<span class="stringliteral">"state.dat"</span>);
</pre></div><p>
and the estimated state : <div class="fragment"><pre class="fragment">      filter.Save_X(<span class="stringliteral">"estimation.dat"</span>);
</pre></div><p>
After compileing and execution, with Gnuplot you can plot : <div class="fragment"><pre class="fragment">  plot <span class="stringliteral">'state.dat'</span> w l, <span class="stringliteral">'estimation.dat'</span> w l, <span class="stringliteral">'output.dat'</span>
</pre></div> To obtain the following graph : <div align="center">
<img src="ornstein.jpg" alt="ornstein.jpg">
</div>
 <h2><a class="anchor" name="sec3">
The CMakeList.txt</a></h2>
<div class="fragment"><pre class="fragment">CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

PROJECT(Van_Der_Pol)
ADD_DEFINITIONS(" -O3")

<span class="preprocessor"># GSL</span>
<span class="preprocessor"></span>SET(BFILT_LIB bfilt)

<span class="preprocessor"># Include et Link Directories</span>
<span class="preprocessor"></span>
IF(APPLE)
  MESSAGE("-- Apple Configuration")
  INCLUDE_DIRECTORIES(
    /sw/include/
    )
ENDIF(APPLE)

<span class="preprocessor"># Executables and "stand-alone " librairies</span>
<span class="preprocessor"></span>ADD_EXECUTABLE (Van_Der_Pol
  van_der_pol.cpp
  example_3.cpp
  )

<span class="preprocessor"># Linkage</span>
<span class="preprocessor"></span>TARGET_LINK_LIBRARIES(Van_Der_Pol
  ${BFILT_LIB}     
  )
</pre></div> </div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Feb 25 15:15:35 2009 for BFilt by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7 </small></address>
</body>
</html>
