<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>BFilt: </title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
</div>
<div class="contents">
This example on the Van der Pol oscillator shows how to use BFilt for non-linear continuous-discrete model. Here the van_der_pol class : <dl class="user" compact><dt><b></b></dt><dd>van_der_pol.h <div class="fragment"><pre class="fragment"><span class="preprocessor">#ifndef __VAN_DER_POL</span>
<span class="preprocessor"></span><span class="preprocessor">#define __VAN_DER_POL</span>
<span class="preprocessor"></span>

<span class="preprocessor">#include &lt;bfilt/gaussian_model.h&gt;</span>


<span class="keyword">class </span>Van_Der_Pol : <span class="keyword">public</span> <a class="code" href="class_continuous___discrete___model.html" title="Continuous Discrete Model: The continuous state :  The discrete Observation .">Continuous_Discrete_Model</a>
{
<span class="keyword">public</span> :
      <span class="keywordtype">double</span> lambda;
      
      Van_Der_Pol(<span class="keywordtype">void</span>);
      dcovector Drift_Function(<span class="keyword">const</span> dcovector &amp; X);
      dgematrix J_Drift_Function(<span class="keyword">const</span> dcovector &amp; X);
      dcovector Observation_Function(<span class="keyword">const</span> dcovector&amp; X);
      dgematrix J_Observation_Function(<span class="keyword">const</span> dcovector &amp; X);
      dgematrix Diffusion_Function(<span class="keywordtype">void</span>);
};


<span class="preprocessor">#endif</span>
</pre></div> van_der_pol.cpp <div class="fragment"><pre class="fragment"><span class="preprocessor">#include "van_der_pol.h"</span>

Van_Der_Pol::Van_Der_Pol(<span class="keywordtype">void</span>)
{
      lambda = 3.;

      Qw.resize(1);
      Qw(0,0)= 1.;
      Qv.resize(1);
      Qv(0,0)=0.1;
  
      X0.resize(2);
      X0(0) = 0.5;
      X0(1) = 0.5;
      R0.resize(2);
      R0.zero();
      R0(0,0)=0.;
      R0(1,1)=.1;
      Ts=.1;

}


dcovector <a class="code" href="class_continuous___discrete___model.html#fb901d0d92470ee3e2f5a06f74336b7d" title="the drift function of dX(t) = F(X)dt + G(X)*dW">Van_Der_Pol::Drift_Function</a>(<span class="keyword">const</span> dcovector &amp; X)
{
      dcovector dX(X.l);

      dX(0) = X(1);
      dX(1) = lambda * (1. - X(0) * X(0)) * X(1) - X(0);

      <span class="keywordflow">return</span> dX;
}

dgematrix <a class="code" href="class_continuous___discrete___model.html#634d515a19cc782505935c8f23b00fff" title="the jacobian of the drift function evaluate at X">Van_Der_Pol::J_Drift_Function</a>(<span class="keyword">const</span> dcovector &amp; X)
{
      dgematrix F(X.l,X.l);

      F(0,0) = 0.;
      F(0,1) = 1.;
      F(1,0) = -2. * lambda * X(0) * X(1);
      F(1,1) = - lambda * X(0) * X(0);

      <span class="keywordflow">return</span> F;
}
dcovector <a class="code" href="class_discrete___observed___model.html#8d56d86ea6b204672c8ebd720f1e11a6" title="The observation Yk=H(Xk) + Vk.">Van_Der_Pol::Observation_Function</a>(<span class="keyword">const</span> dcovector&amp; X)
{
      dcovector Y(1);
      Y(0) = X(0);
      <span class="keywordflow">return</span> Y;
}

dgematrix <a class="code" href="class_discrete___observed___model.html#83cd1f2f54544d8977dbce844031f85e" title="the jacobian of the observation function evaluate at X">Van_Der_Pol::J_Observation_Function</a>(<span class="keyword">const</span> dcovector &amp; X)
{
      dgematrix H(1,2);
      H(0,0) = 0.;
      H(0,1) = 1.;
      <span class="keywordflow">return</span> H;
}
dgematrix <a class="code" href="class_continuous___discrete___model.html#e305ba43f31be1275ede8d3d48d1d779" title="the diffusion function">Van_Der_Pol::Diffusion_Function</a>(<span class="keywordtype">void</span>)
{
      dgematrix G(2,1);
      G(0,0) = 0.;
      G(1,0) = 1.;

      <span class="keywordflow">return</span> G;
}
</pre></div></dd></dl>
Results can be plotted (here with gnuplot): <div align="center">
<img src="van_der_pol.jpg" alt="van_der_pol.jpg">
</div>
  </div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue Nov 4 22:13:26 2008 for BFilt by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7 </small></address>
</body>
</html>
