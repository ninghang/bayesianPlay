<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>BFilt: An AR process</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="page1">An AR process </a></h1>This is an example on the following auto regressive (AR) process : <p class="formulaDsp">
<img class="formulaDsp" alt="\[ X_k = 0.8 X_{k-1} + Wk \]" src="form_24.png">
<p>
 where, <img class="formulaInl" alt="$ X_{k} \in \mathcal{R} $" src="form_25.png">, <img class="formulaInl" alt="$ W_k \sim \mathcal{N}(0,0.1) $" src="form_26.png"> <dl class="user" compact><dt><b></b></dt><dd></dd></dl>
This state is then observed by the output <img class="formulaInl" alt="$ Y_k \in \mathcal{R} $" src="form_27.png"> : <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Y_k = X_k + V_k \]" src="form_28.png">
<p>
 where <img class="formulaInl" alt="$ V_k \sim \mathcal{N}(0,1) $" src="form_29.png"><h2><a class="anchor" name="sec1">
Define the AR model</a></h2>
First the ar process must be define as a sister class of <a class="el" href="class_gaussian___linear___model.html" title="Gaussian Linear Model :.">Gaussian_Linear_Model</a>. <div class="fragment"><pre class="fragment"><span class="preprocessor">#ifndef __AR_PROCESS</span>
<span class="preprocessor"></span><span class="preprocessor">#define __AR_PROCESS</span>
<span class="preprocessor"></span>
<span class="preprocessor">#include &lt;bfilt/gaussian_model.h&gt;</span>

<span class="keyword">class </span>AR_Process : <span class="keyword">public</span> <a class="code" href="class_gaussian___linear___model.html" title="Gaussian Linear Model :.">Gaussian_Linear_Model</a>
{
<span class="keyword">public</span> :
      AR_Process(<span class="keywordtype">void</span>);
};


<span class="preprocessor">#endif</span>
</pre></div> The Gaussian Linear <a class="el" href="class_model.html" title="The class of time varying-models.">Model</a> are implemented in the following form : <p class="formulaDsp">
<img class="formulaDsp" alt="\[ X_k = F X_{k-1} + f + G W_k \]" src="form_30.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Y_k = H X_{k-1} + h + V_k \]" src="form_31.png">
<p>
 The constructor of AR_Process is then : <div class="fragment"><pre class="fragment"><span class="preprocessor">#include "ar_process.h"</span>

AR_Process::AR_Process(<span class="keywordtype">void</span>)
{
      <span class="comment">// State Equation</span>
      F.resize(1,1);
      F(0,0) = 0.8;

      f.resize(1);
      f(0) = 0.;
      
      G.resize(1,1);
      G.identity();
      
      Qw.resize(1);
      Qw(0,0)= 0.1;

      <span class="comment">// Observation noise</span>
      H.resize(1,1);
      H(0,0) = 1;

      h.resize(1);
      h(0) = 0.;

      Qv.resize(1);
      Qv(0,0)=1;
  
      <span class="comment">// Init state </span>
      X0.resize(1);
      X0(0) = 10.;

      R0.resize(1);
      R0.zero();
}
</pre></div><h2><a class="anchor" name="sec2">
The main program</a></h2>
In the main program, the model will be first simulted with a specific simulator for gaussian model (<a class="el" href="class_g___simulator.html">G_Simulator</a>). Then the simulated output sequence <img class="formulaInl" alt="$ y_{0:N}$" src="form_11.png"> is given to the input of a discrete-discrete kalman filter (DD_Filter) to estimate the state <img class="formulaInl" alt="$ \hat{X}_{0:k} $" src="form_32.png">. First, all this objects are declared :<p>
 <div class="fragment"><pre class="fragment"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
{
      AR_Process model;            <span class="comment">// The AR model</span>

      <a class="code" href="class_g___simulator.html">G_Simulator</a> sim(&amp;model);      <span class="comment">// The simulator</span>
      
      <a class="code" href="class_d_d___kalman.html" title="The discrete-discrete kalman filter.">DD_Kalman</a>  filter(&amp;model);   <span class="comment">// The Kalman filter </span>
</pre></div><p>
Then 100 samples are simulated : <div class="fragment"><pre class="fragment">      sim.Simulate(100);
</pre></div> The kalman filter is apply on the output sequence : <div class="fragment"><pre class="fragment"></pre></div> You can save the simulated sequences : <div class="fragment"><pre class="fragment">      sim.Save_Y(<span class="stringliteral">"output.dat"</span>);
      sim.Save_X(<span class="stringliteral">"state.dat"</span>);
</pre></div><p>
and the estimated state : <div class="fragment"><pre class="fragment">      filter.Save_X(<span class="stringliteral">"estimation.dat"</span>);
</pre></div><p>
After compileing and execution, with Gnuplot you can plot : <div class="fragment"><pre class="fragment">  plot <span class="stringliteral">'state.dat'</span> w l, <span class="stringliteral">'estimation.dat'</span> w l, <span class="stringliteral">'output.dat'</span>
</pre></div> To obtain the following graph : <div align="center">
<img src="ar_process.jpg" alt="ar_process.jpg">
</div>
 <h2><a class="anchor" name="sec3">
The CMakeList.txt</a></h2>
<div class="fragment"><pre class="fragment">CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

PROJECT(Van_Der_Pol)
ADD_DEFINITIONS(" -O3")

<span class="preprocessor"># GSL</span>
<span class="preprocessor"></span>SET(BFILT_LIB bfilt)

<span class="preprocessor"># Include et Link Directories</span>
<span class="preprocessor"></span>
IF(APPLE)
  MESSAGE("-- Apple Configuration")
  INCLUDE_DIRECTORIES(
    /sw/include/
    )
ENDIF(APPLE)

<span class="preprocessor"># Executables and "stand-alone " librairies</span>
<span class="preprocessor"></span>ADD_EXECUTABLE (Van_Der_Pol
  van_der_pol.cpp
  example_3.cpp
  )

<span class="preprocessor"># Linkage</span>
<span class="preprocessor"></span>TARGET_LINK_LIBRARIES(Van_Der_Pol
  ${BFILT_LIB}     
  )
</pre></div> </div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Feb 25 15:15:34 2009 for BFilt by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7 </small></address>
</body>
</html>
