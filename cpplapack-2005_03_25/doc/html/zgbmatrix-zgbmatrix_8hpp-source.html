<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CPPLapack: zgbmatrix-zgbmatrix.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href="dir_000025.html">zgbmatrix-</a></div>
<h1>zgbmatrix-zgbmatrix.hpp</h1><a href="zgbmatrix-zgbmatrix_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">//=============================================================================</span><span class="comment"></span>
00002 <span class="comment">/*! zgbmatrix=zgbmatrix operator\n</span>
00003 <span class="comment">  The left side matrix is overwritten thoroughly including band width. */</span>
<a name="l00004"></a><a class="code" href="classzgbmatrix.html#a20">00004</a> <span class="keyword">inline</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; <a class="code" href="classzgbmatrix.html#a20">zgbmatrix::operator=</a>(<span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; mat)
00005 {
00006 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00007 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zgbmatrix::operator=(const zgbmatrix&amp;)"</span>
00008             &lt;&lt; std::endl;
00009 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00010 <span class="preprocessor"></span>  
00011   <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r4">Array</a>!=mat.Array){ <span class="comment">// if it is NOT self substitution</span>
00012     <a class="code" href="classzgbmatrix.html#a15">copy</a>(mat);
00013   }
00014   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00015 }
00016 <span class="comment"></span>
00017 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00018 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00019 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00020 <span class="comment"></span>
00021 <span class="comment">//=============================================================================</span><span class="comment"></span>
00022 <span class="comment">/*! zgbmatrix+=zgbmatrix operator\n</span>
00023 <span class="comment">  If the band width of the left side matrix is narrower than the right side matrix, the band width of the left side matrix become thicker as same as the right side matrix. */</span>
<a name="l00024"></a><a class="code" href="classzgbmatrix.html#a21">00024</a> <span class="keyword">inline</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; <a class="code" href="classzgbmatrix.html#a21">zgbmatrix::operator+=</a>(<span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; mat)
00025 {
00026 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00027 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zgbmatrix::operator+=(const zgbmatrix&amp;)"</span>
00028             &lt;&lt; std::endl;
00029 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00030 <span class="preprocessor"></span>  
00031 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00032 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r1">N</a>!=mat.N || <a class="code" href="classzgbmatrix.html#r0">M</a>!=mat.M){
00033     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] zgbmatrix::operator+=(zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00034               &lt;&lt; <span class="stringliteral">"These two matrises can not make a summation."</span> &lt;&lt; std::endl
00035               &lt;&lt; <span class="stringliteral">"Your input was"</span>
00036               &lt;&lt; <span class="stringliteral">"("</span> &lt;&lt; <a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt;<span class="stringliteral">"x"</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt;<span class="stringliteral">","</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r2">KL</a> &lt;&lt;<span class="stringliteral">":"</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r3">KU</a> &lt;&lt; <span class="stringliteral">") "</span>&lt;&lt; <span class="stringliteral">"+="</span>
00037               &lt;&lt; <span class="stringliteral">"("</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt;<span class="stringliteral">"x"</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt;<span class="stringliteral">","</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r2">KL</a> &lt;&lt;<span class="stringliteral">":"</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r3">KU</a> &lt;&lt;<span class="stringliteral">") "</span>
00038               &lt;&lt; std::endl;
00039     exit(1);
00040   }
00041 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00042 <span class="preprocessor"></span>  
00043   <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r2">KL</a>&gt;=mat.KL &amp;&amp; <a class="code" href="classzgbmatrix.html#r3">KU</a>&gt;=mat.KU){
00044     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzgbmatrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzgbmatrix.html#r0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00045       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-mat.KL); j&lt;min(<a class="code" href="classzgbmatrix.html#r1">N</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+mat.KU+1); j++){
00046         <a class="code" href="classzgbmatrix.html#a6">operator()</a>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00047       }
00048     }
00049     
00050     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00051   }
00052   
00053   <span class="keywordflow">else</span>{
00054     <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat(<a class="code" href="classzgbmatrix.html#r0">M</a>,<a class="code" href="classzgbmatrix.html#r1">N</a>,max(<a class="code" href="classzgbmatrix.html#r2">KL</a>,mat.KL),max(<a class="code" href="classzgbmatrix.html#r3">KU</a>,mat.KU));
00055     newmat.<a class="code" href="classzgbmatrix.html#a12">zero</a>();
00056     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzgbmatrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzgbmatrix.html#r0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00057       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-<a class="code" href="classzgbmatrix.html#r2">KL</a>); j&lt;min(<a class="code" href="classzgbmatrix.html#r1">N</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+<a class="code" href="classzgbmatrix.html#r3">KU</a>+1); j++){
00058         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=<a class="code" href="classzgbmatrix.html#a6">operator()</a>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00059       }
00060       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-mat.KL); j&lt;min(mat.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+mat.KU+1); j++){
00061         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00062       }
00063     }
00064     
00065     <a class="code" href="classzgbmatrix.html#n10">swap</a>(*<span class="keyword">this</span>,newmat);
00066     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00067   }
00068 }
00069 
00070 <span class="comment">//=============================================================================</span><span class="comment"></span>
00071 <span class="comment">/*! zgbmatrix-=zgbmatrix operator\n</span>
00072 <span class="comment">  If the band width of the left side matrix is narrower than the right side matrix, the band width of the left side matrix become thicker as same as the right side matrix. */</span>
<a name="l00073"></a><a class="code" href="classzgbmatrix.html#a22">00073</a> <span class="keyword">inline</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; <a class="code" href="classzgbmatrix.html#a22">zgbmatrix::operator-=</a>(<span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; mat)
00074 {
00075 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00076 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zgbmatrix::operator-=(const zgbmatrix&amp;)"</span>
00077             &lt;&lt; std::endl;
00078 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00079 <span class="preprocessor"></span>  
00080 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00081 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r1">N</a>!=mat.N || <a class="code" href="classzgbmatrix.html#r0">M</a>!=mat.M){
00082     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] zgbmatrix::operator-=(zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00083               &lt;&lt; <span class="stringliteral">"These two matrises can not make a subtraction."</span> &lt;&lt; std::endl
00084               &lt;&lt; <span class="stringliteral">"Your input was"</span>
00085               &lt;&lt; <span class="stringliteral">"("</span> &lt;&lt; <a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt;<span class="stringliteral">"x"</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt;<span class="stringliteral">","</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r2">KL</a> &lt;&lt;<span class="stringliteral">":"</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r3">KU</a> &lt;&lt; <span class="stringliteral">") "</span>&lt;&lt; <span class="stringliteral">"-="</span>
00086               &lt;&lt; <span class="stringliteral">"("</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt;<span class="stringliteral">"x"</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt;<span class="stringliteral">","</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r2">KL</a> &lt;&lt;<span class="stringliteral">":"</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r3">KU</a> &lt;&lt;<span class="stringliteral">") "</span>
00087               &lt;&lt; std::endl;
00088     exit(1);
00089   }
00090 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00091 <span class="preprocessor"></span>  
00092   <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r2">KL</a>&gt;=mat.KL &amp;&amp; <a class="code" href="classzgbmatrix.html#r3">KU</a>&gt;=mat.KU){
00093     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzgbmatrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzgbmatrix.html#r0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00094       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-mat.KL); j&lt;min(<a class="code" href="classzgbmatrix.html#r1">N</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+mat.KU+1); j++){
00095         <a class="code" href="classzgbmatrix.html#a6">operator()</a>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)-=mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00096       }
00097     }
00098     
00099     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00100   }
00101   
00102   <span class="keywordflow">else</span>{
00103     <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat(<a class="code" href="classzgbmatrix.html#r0">M</a>,<a class="code" href="classzgbmatrix.html#r1">N</a>,max(<a class="code" href="classzgbmatrix.html#r2">KL</a>,mat.KL),max(<a class="code" href="classzgbmatrix.html#r3">KU</a>,mat.KU));
00104     newmat.<a class="code" href="classzgbmatrix.html#a12">zero</a>();
00105     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzgbmatrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzgbmatrix.html#r0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00106       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-<a class="code" href="classzgbmatrix.html#r2">KL</a>); j&lt;min(<a class="code" href="classzgbmatrix.html#r1">N</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+<a class="code" href="classzgbmatrix.html#r3">KU</a>+1); j++){
00107         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=<a class="code" href="classzgbmatrix.html#a6">operator()</a>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00108       }
00109       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-mat.KL); j&lt;min(mat.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+mat.KU+1); j++){
00110         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)-=mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00111       }
00112     }
00113     
00114     <a class="code" href="classzgbmatrix.html#n10">swap</a>(*<span class="keyword">this</span>,newmat);
00115     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00116   }
00117 }
00118 
00119 <span class="comment">//=============================================================================</span><span class="comment"></span>
00120 <span class="comment">/*! zgbmatrix*=zgbmatrix operator */</span>
<a name="l00121"></a><a class="code" href="classzgbmatrix.html#a23">00121</a> <span class="keyword">inline</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; <a class="code" href="classzgbmatrix.html#a23">zgbmatrix::operator*=</a>(<span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; mat)
00122 {
00123 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00124 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zgbmatrix::operator*=(const zgbmatrix&amp;)"</span>
00125             &lt;&lt; std::endl;
00126 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00127 <span class="preprocessor"></span>  
00128 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00129 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r1">N</a>!=mat.M){
00130     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] zgbmatrix::operator*=(zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00131               &lt;&lt; <span class="stringliteral">"These two matrises can not make a product."</span> &lt;&lt; std::endl
00132               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">") * ("</span>
00133               &lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00134     exit(1);
00135   }
00136 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00137 <span class="preprocessor"></span>  
00138   <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat( <a class="code" href="classzgbmatrix.html#r0">M</a>, mat.N, <a class="code" href="classzgbmatrix.html#r3">KU</a>+mat.KL-1, <a class="code" href="classzgbmatrix.html#r2">KL</a>+mat.KU+1 );
00139   newmat.<a class="code" href="classzgbmatrix.html#a12">zero</a>();
00140   
00141   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzgbmatrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;newmat.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00142     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-newmat.kl); j&lt;min(newmat.n,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+newmat.ku+1); j++){
00143       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> k=max( max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-<a class="code" href="classzgbmatrix.html#r2">KL</a>), max(0,j-mat.KU) );
00144           k&lt; min( min(<a class="code" href="classzgbmatrix.html#r1">N</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+<a class="code" href="classzgbmatrix.html#r3">KU</a>+1), min(mat.M,j+mat.KL+1) ); k++){
00145         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+= <a class="code" href="classzgbmatrix.html#a6">operator()</a>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,k)*mat(k,j);
00146       }
00147     }
00148   }
00149   
00150   <a class="code" href="classzgbmatrix.html#n10">swap</a>(*<span class="keyword">this</span>,newmat);
00151   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00152 }
00153 <span class="comment"></span>
00154 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00155 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00156 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00157 <span class="comment"></span>
00158 <span class="comment">//=============================================================================</span><span class="comment"></span>
00159 <span class="comment">/*! zgbmatrix+zgbmatrix operator */</span>
<a name="l00160"></a><a class="code" href="zgbmatrix-zgbmatrix_8hpp.html#a0">00160</a> <span class="keyword">inline</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a> <a class="code" href="__dcovector-__dcovector_8hpp.html#a0">operator+</a>(<span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; matA, <span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; matB)
00161 {
00162 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00163 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] operator+(const zgbmatrix&amp;, const zgbmatrix&amp;)"</span>
00164             &lt;&lt; std::endl;
00165 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00166 <span class="preprocessor"></span>  
00167 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00168 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(matA.N!=matB.N || matA.M!=matB.M){
00169     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] operator+(zgbmatrix&amp;, zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00170               &lt;&lt; <span class="stringliteral">"These two matrises can not make a summation."</span> &lt;&lt; std::endl
00171               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; matA.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matA.N &lt;&lt; <span class="stringliteral">") + ("</span>
00172               &lt;&lt; matB.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.N &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00173     exit(1);
00174   }
00175 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00176 <span class="preprocessor"></span>  
00177   <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat(matA.M,matA.N,max(matA.KL,matB.KL),max(matA.KU,matB.KU));
00178   newmat.zero();
00179   
00180   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;matA.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00181     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matA.KL); j&lt;min(matA.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matA.KU+1); j++){
00182       newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=matA(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00183     }
00184     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matB.KL); j&lt;min(matB.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matB.KU+1); j++){
00185       newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=matB(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00186     }
00187   }
00188   
00189   <span class="keywordflow">return</span> <a class="code" href="dcovector-misc_8hpp.html#a1">_</a>(newmat);
00190 }
00191 
00192 <span class="comment">//=============================================================================</span><span class="comment"></span>
00193 <span class="comment">/*! zgbmatrix-zgbmatrix operator */</span>
<a name="l00194"></a><a class="code" href="zgbmatrix-zgbmatrix_8hpp.html#a1">00194</a> <span class="keyword">inline</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a> <a class="code" href="__dcovector-__dcovector_8hpp.html#a1">operator-</a>(<span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; matA, <span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; matB)
00195 {
00196 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00197 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] operator-(const zgbmatrix&amp;, const zgbmatrix&amp;)"</span>
00198             &lt;&lt; std::endl;
00199 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00200 <span class="preprocessor"></span>  
00201 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00202 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(matA.N!=matB.N || matA.M!=matB.M){
00203     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] operator-(zgbmatrix&amp;, zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00204               &lt;&lt; <span class="stringliteral">"These two matrises can not make a subtraction."</span> &lt;&lt; std::endl
00205               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; matA.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matA.N &lt;&lt; <span class="stringliteral">") - ("</span>
00206               &lt;&lt; matB.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.N &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00207     exit(1);
00208   }
00209 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00210 <span class="preprocessor"></span>  
00211   <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat(matA.M,matA.N,max(matA.KL,matB.KL),max(matA.KU,matB.KU));
00212   newmat.zero();
00213   
00214   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;matA.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00215     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matA.KL); j&lt;min(matA.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matA.KU+1); j++){
00216       newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=matA(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00217     }
00218     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matB.KL); j&lt;min(matB.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matB.KU+1); j++){
00219       newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)-=matB(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00220     }
00221   }
00222   
00223   <span class="keywordflow">return</span> <a class="code" href="dcovector-misc_8hpp.html#a1">_</a>(newmat);
00224 }
00225 
00226 <span class="comment">//=============================================================================</span><span class="comment"></span>
00227 <span class="comment">/*! zgbmatrix*zgbmatrix operator */</span>
<a name="l00228"></a><a class="code" href="zgbmatrix-zgbmatrix_8hpp.html#a2">00228</a> <span class="keyword">inline</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a> <a class="code" href="__dcovector-__drovector_8hpp.html#a0">operator*</a>(<span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; matA, <span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; matB)
00229 {
00230 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00231 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] operator*(const zgbmatrix&amp;, const zgbmatrix&amp;)"</span>
00232             &lt;&lt; std::endl;
00233 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00234 <span class="preprocessor"></span>  
00235 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00236 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(matA.N!=matB.M){
00237     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] operator*(zgbmatrix&amp;, zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00238               &lt;&lt; <span class="stringliteral">"These two matrises can not make a product."</span> &lt;&lt; std::endl
00239               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; matA.<a class="code" href="class__dgematrix.html#o0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matA.<a class="code" href="class__dgematrix.html#o1">N</a> &lt;&lt; <span class="stringliteral">") * ("</span>
00240               &lt;&lt; matB.<a class="code" href="class__dgematrix.html#o0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.<a class="code" href="class__dgematrix.html#o1">N</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00241     exit(1);
00242   }
00243 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00244 <span class="preprocessor"></span>  
00245   <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat( matA.M, matB.N, matA.KU+matB.KL-1, matA.KL+matB.KU+1 );
00246   newmat.zero();
00247   
00248   <span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>, j, k;
00249 <span class="preprocessor">#pragma omp parallel for private(j,k)</span>
00250 <span class="preprocessor"></span>  <span class="keywordflow">for</span>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;newmat.m; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00251     <span class="keywordflow">for</span>(j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-newmat.kl); j&lt;min(newmat.n,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+newmat.ku+1); j++){
00252       <span class="keywordflow">for</span>(k=max( max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matA.KL), max(0,j-matB.KU) );
00253           k&lt; min( min(matA.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matA.KU+1), min(matB.M,j+matB.KL+1) ); k++){
00254         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+= matA(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,k)*matB(k,j);
00255       }
00256     }
00257   }
00258   
00259   <span class="keywordflow">return</span> <a class="code" href="dcovector-misc_8hpp.html#a1">_</a>(newmat);
00260 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Mar 25 17:28:24 2005 for CPPLapack by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
