<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CPPLapack: zhematrix-misc.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href="dir_000027.html">zhematrix-</a></div>
<h1>zhematrix-misc.hpp</h1><a href="zhematrix-misc_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">//=============================================================================</span><span class="comment"></span>
00002 <span class="comment">/*! complete the upper-right components */</span>
<a name="l00003"></a><a class="code" href="classzhematrix.html#a13">00003</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classzhematrix.html#a13">zhematrix::complete</a>()<span class="keyword"> const</span>
00004 <span class="keyword"></span>{
00005 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00006 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::complete() const"</span>
00007             &lt;&lt; std::endl;
00008 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00009 <span class="preprocessor"></span>  
00010   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzhematrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00011     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>; j++){
00012       <a class="code" href="classzhematrix.html#r2">Darray</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>][j] =<a class="code" href="__zcovector-calc_8hpp.html#a1">std::conj</a>(<a class="code" href="classzhematrix.html#r2">Darray</a>[j][<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>]);
00013     }    
00014 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00015 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(std::fabs(std::imag(<span class="keyword">operator</span>()(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>))) &gt; CPPL_EPS){
00016       std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] zhematrix::complete() const"</span> &lt;&lt; std::endl
00017                 &lt;&lt; <span class="stringliteral">"The "</span> &lt;&lt; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a> &lt;&lt; <span class="stringliteral">"th diagonal component of the zhematrix"</span>
00018                 &lt;&lt; <span class="stringliteral">"is not a real number."</span> &lt;&lt; std::endl;
00019     }
00020 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00021 <span class="preprocessor"></span>  }
00022 }
00023 
00024 <span class="comment">//=============================================================================</span><span class="comment"></span>
00025 <span class="comment">/*! clear all the matrix data and set the sizes 0 */</span>
<a name="l00026"></a><a class="code" href="classzhematrix.html#a14">00026</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classzhematrix.html#a14">zhematrix::clear</a>()
00027 {
00028 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00029 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::clear()"</span>
00030             &lt;&lt; std::endl;
00031 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00032 <span class="preprocessor"></span>  
00033 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00034 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [NOTE] zhematrix::clear() "</span>
00035             &lt;&lt; <span class="stringliteral">" An array at "</span> &lt;&lt; <a class="code" href="classzhematrix.html#r1">Array</a>
00036             &lt;&lt; <span class="stringliteral">" is going to be cleared."</span> &lt;&lt; std::endl;
00037 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00038 <span class="preprocessor"></span>  
00039   <a class="code" href="classzhematrix.html#r0">N</a> =0;
00040   <span class="keyword">delete</span> [] <a class="code" href="classzhematrix.html#r1">Array</a>;
00041   <a class="code" href="classzhematrix.html#r1">Array</a> =NULL;
00042   <span class="keyword">delete</span> [] <a class="code" href="classzhematrix.html#r2">Darray</a>;
00043   <a class="code" href="classzhematrix.html#r2">Darray</a> =NULL;
00044 }
00045 
00046 <span class="comment">//=============================================================================</span><span class="comment"></span>
00047 <span class="comment">/*! change the matrix into a zero matrix */</span>
<a name="l00048"></a><a class="code" href="classzhematrix.html#a15">00048</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classzhematrix.html#a15">zhematrix::zero</a>()
00049 {
00050 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00051 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::zero()"</span>
00052             &lt;&lt; std::endl;
00053 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00054 <span class="preprocessor"></span>  
00055   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzhematrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;=<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>; j++){
00056     <a class="code" href="classzhematrix.html#r1">Array</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>] =std::complex&lt;double&gt;(0.0,0.0);
00057   }}
00058 }
00059 
00060 <span class="comment">//=============================================================================</span><span class="comment"></span>
00061 <span class="comment">/*! change the matrix into an identity matrix */</span>
<a name="l00062"></a><a class="code" href="classzhematrix.html#a16">00062</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classzhematrix.html#a16">zhematrix::identity</a>()
00063 {
00064 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00065 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::identity()"</span>
00066             &lt;&lt; std::endl;
00067 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00068 <span class="preprocessor"></span>  
00069   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzhematrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00070     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>; j++){
00071       <a class="code" href="classzhematrix.html#r2">Darray</a>[j][<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>] =std::complex&lt;double&gt;(0.0,0.0);
00072     }
00073     <a class="code" href="classzhematrix.html#r2">Darray</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>][<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>] =std::complex&lt;double&gt;(1.0,0.0);
00074   }
00075 }
00076 
00077 <span class="comment">//=============================================================================</span><span class="comment"></span>
00078 <span class="comment">/*! change sign(+/-) of the matrix */</span>
<a name="l00079"></a><a class="code" href="classzhematrix.html#a17">00079</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classzhematrix.html#a17">zhematrix::chsign</a>()
00080 {
00081 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00082 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::chsign()"</span>
00083             &lt;&lt; std::endl;
00084 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00085 <span class="preprocessor"></span>  
00086   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzhematrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00087     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;=<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>; j++){
00088       <a class="code" href="classzhematrix.html#r2">Darray</a>[j][<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>] =-<a class="code" href="classzhematrix.html#r2">Darray</a>[j][<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>];
00089     }
00090   }
00091 }
00092 
00093 <span class="comment">//=============================================================================</span><span class="comment"></span>
00094 <span class="comment">/*! make a deep copy of the matrix */</span>
<a name="l00095"></a><a class="code" href="classzhematrix.html#a18">00095</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classzhematrix.html#a18">zhematrix::copy</a>(<span class="keyword">const</span> <a class="code" href="classzhematrix.html">zhematrix</a>&amp; mat)
00096 {
00097 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00098 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::copy(const zhematrix&amp;)"</span>
00099             &lt;&lt; std::endl;
00100 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00101 <span class="preprocessor"></span>  
00102 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00103 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [NOTE] zhematrix::copy(const zhematrix&amp;) "</span>
00104             &lt;&lt; <span class="stringliteral">"A zhematrix at "</span> &lt;&lt; <a class="code" href="classzhematrix.html#r1">Array</a> &lt;&lt; <span class="stringliteral">" is going to be deleted."</span>;
00105 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00106 <span class="preprocessor"></span>  
00107   <a class="code" href="classzhematrix.html#r0">N</a> =mat.<a class="code" href="class__dgematrix.html#o1">N</a>;
00108   <span class="keyword">delete</span> [] Array;
00109   Array =<span class="keyword">new</span> std::complex&lt;double&gt;[<a class="code" href="classzhematrix.html#r0">N</a>*<a class="code" href="classzhematrix.html#r0">N</a>];
00110   <span class="keyword">delete</span> [] <a class="code" href="classzhematrix.html#r2">Darray</a>;
00111   <a class="code" href="classzhematrix.html#r2">Darray</a> =<span class="keyword">new</span> std::complex&lt;double&gt;*[<a class="code" href="classzhematrix.html#r0">N</a>];
00112   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="classzhematrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzhematrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <a class="code" href="classzhematrix.html#r2">Darray</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>] =&amp;Array[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>*N]; }
00113   
00114   zcopy_(mat.N*mat.N, mat.Array, 1, Array, 1);
00115   
00116 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00117 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">" Then, a COPY of a zhematrix has been cleated at "</span>
00118             &lt;&lt; Array &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; std::endl;
00119 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00120 <span class="preprocessor"></span>}
00121 
00122 <span class="comment">//=============================================================================</span><span class="comment"></span>
00123 <span class="comment">/*! make a shallow copy of the matrix\n</span>
00124 <span class="comment">  This function is not designed to be used in project codes. */</span>
<a name="l00125"></a><a class="code" href="classzhematrix.html#a19">00125</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classzhematrix.html#a19">zhematrix::shallow_copy</a>(<span class="keyword">const</span> <a class="code" href="class__zhematrix.html">_zhematrix</a>&amp; mat)
00126 {
00127 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00128 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::shallow_copy(const _zhematrix&amp;)"</span>
00129             &lt;&lt; std::endl;
00130 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00131 <span class="preprocessor"></span>  
00132 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00133 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [NOTE] zhematrix:shallow_copy(const _zhematrix&amp;) "</span>
00134             &lt;&lt; <span class="stringliteral">"A zhematrix at "</span> &lt;&lt; <a class="code" href="classzhematrix.html#r1">Array</a> &lt;&lt; <span class="stringliteral">" is going to be deleted, "</span>
00135             &lt;&lt; <span class="stringliteral">"and point at "</span> &lt;&lt; mat.<a class="code" href="class__dgematrix.html#o2">Array</a> &lt;&lt; <span class="stringliteral">" instead."</span> &lt;&lt; std::endl;
00136 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00137 <span class="preprocessor"></span>  
00138   <a class="code" href="classzhematrix.html#r0">N</a> =mat.<a class="code" href="class__dgematrix.html#o1">N</a>;
00139   <span class="keyword">delete</span> [] <a class="code" href="classzhematrix.html#r1">Array</a>;
00140   <a class="code" href="classzhematrix.html#r1">Array</a> =mat.<a class="code" href="class__dgematrix.html#o2">Array</a>;
00141   <span class="keyword">delete</span> [] <a class="code" href="classzhematrix.html#r2">Darray</a>;
00142   <a class="code" href="classzhematrix.html#r2">Darray</a> =mat.<a class="code" href="class__dgematrix.html#o3">Darray</a>;
00143 }
00144 
00145 <span class="comment">//=============================================================================</span><span class="comment"></span>
00146 <span class="comment">/*! resize the matrix */</span>
<a name="l00147"></a><a class="code" href="classzhematrix.html#a20">00147</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classzhematrix.html#a20">zhematrix::resize</a>(<span class="keyword">const</span> <span class="keywordtype">long</span>&amp; _n)
00148 {
00149 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00150 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::resize(const long&amp;)"</span>
00151             &lt;&lt; std::endl;
00152 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00153 <span class="preprocessor"></span>  
00154 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00155 <span class="preprocessor"></span>  <span class="keywordflow">if</span>( _n&lt;0 ){
00156     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] zhematrix::resize(const long&amp;, const long&amp;)"</span>
00157               &lt;&lt; std::endl
00158               &lt;&lt; <span class="stringliteral">"Matrix sizes must be positive integers."</span> &lt;&lt; std::endl
00159               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; _n &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00160     exit(1);
00161   }
00162 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00163 <span class="preprocessor"></span>  
00164   <a class="code" href="classzhematrix.html#r0">N</a> =_n;
00165   <span class="keyword">delete</span> [] <a class="code" href="classzhematrix.html#r1">Array</a>;
00166   <a class="code" href="classzhematrix.html#r1">Array</a> =<span class="keyword">new</span> std::complex&lt;double&gt;[<a class="code" href="classzhematrix.html#r0">N</a>*<a class="code" href="classzhematrix.html#r0">N</a>];
00167   <span class="keyword">delete</span> [] <a class="code" href="classzhematrix.html#r2">Darray</a>;
00168   <a class="code" href="classzhematrix.html#r2">Darray</a> =<span class="keyword">new</span> std::complex&lt;double&gt;*[<a class="code" href="classzhematrix.html#r0">N</a>];
00169   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="classzhematrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzhematrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <a class="code" href="classzhematrix.html#r2">Darray</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>] =&amp;<a class="code" href="classzhematrix.html#r1">Array</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>*N]; }
00170 }
00171 
00172 <span class="comment">//=============================================================================</span><span class="comment"></span>
00173 <span class="comment">/*! swap two matrices */</span>
<a name="l00174"></a><a class="code" href="zhematrix-misc_8hpp.html#a0">00174</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="dcovector-misc_8hpp.html#a0">swap</a>(<a class="code" href="classzhematrix.html">zhematrix</a>&amp; A, <a class="code" href="classzhematrix.html">zhematrix</a>&amp; B)
00175 {
00176 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00177 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] swap(zhematrix&amp;, zhematrix&amp;)"</span>
00178             &lt;&lt; std::endl;
00179 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00180 <span class="preprocessor"></span>  
00181   <span class="keywordtype">long</span> A_n(A.N);
00182   std::complex&lt;double&gt;* A_array(A.Array);
00183   std::complex&lt;double&gt;** A_darray(A.Darray);
00184   A.<a class="code" href="class__dgematrix.html#o1">N</a>=B.<a class="code" href="class__dgematrix.html#o1">N</a>; A.<a class="code" href="class__dgematrix.html#o2">Array</a>=B.<a class="code" href="class__dgematrix.html#o2">Array</a>; A.<a class="code" href="class__dgematrix.html#o3">Darray</a>=B.<a class="code" href="class__dgematrix.html#o3">Darray</a>;
00185   B.<a class="code" href="class__dgematrix.html#o1">N</a>=A_n; B.<a class="code" href="class__dgematrix.html#o2">Array</a>=A_array; B.<a class="code" href="class__dgematrix.html#o3">Darray</a>=A_darray;
00186 }
00187 
00188 <span class="comment">//=============================================================================</span><span class="comment"></span>
00189 <span class="comment">/*! convert user object to smart-temporary object */</span>
<a name="l00190"></a><a class="code" href="zhematrix-misc_8hpp.html#a1">00190</a> <span class="keyword">inline</span> <a class="code" href="class__zhematrix.html">_zhematrix</a> <a class="code" href="dcovector-misc_8hpp.html#a1">_</a>(<a class="code" href="classzhematrix.html">zhematrix</a>&amp; mat)
00191 {
00192 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00193 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] _(zhematrix&amp;)"</span>
00194             &lt;&lt; std::endl;
00195 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00196 <span class="preprocessor"></span>
00197   <a class="code" href="class__zhematrix.html">_zhematrix</a> newmat;
00198 
00199   newmat.<a class="code" href="class__zhematrix.html#o0">N</a> =mat.<a class="code" href="class__zhematrix.html#o0">N</a>;
00200   newmat.<a class="code" href="class__zhematrix.html#o1">Array</a> =mat.<a class="code" href="class__zhematrix.html#o1">Array</a>;
00201   newmat.<a class="code" href="class__zhematrix.html#o2">Darray</a> =mat.<a class="code" href="class__zhematrix.html#o2">Darray</a>;
00202 
00203   mat.<a class="code" href="class__zhematrix.html#o0">N</a> =0;
00204   mat.<a class="code" href="class__zhematrix.html#o1">Array</a> =NULL;
00205   mat.<a class="code" href="class__zhematrix.html#o2">Darray</a> =NULL;
00206 
00207   <span class="keywordflow">return</span> newmat;
00208 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Mar 25 17:28:24 2005 for CPPLapack by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
