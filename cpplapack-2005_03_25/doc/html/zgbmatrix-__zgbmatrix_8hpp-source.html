<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CPPLapack: zgbmatrix-_zgbmatrix.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href="dir_000025.html">zgbmatrix-</a></div>
<h1>zgbmatrix-_zgbmatrix.hpp</h1><a href="zgbmatrix-__zgbmatrix_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">//=============================================================================</span><span class="comment"></span>
00002 <span class="comment">/*! zgbmatrix=_zgbmatrix operator */</span>
<a name="l00003"></a><a class="code" href="classzgbmatrix.html#a24">00003</a> <span class="keyword">inline</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; <a class="code" href="classzgbmatrix.html#a20">zgbmatrix::operator=</a>(<span class="keyword">const</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a>&amp; mat)
00004 {
00005 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00006 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zgbmatrix::operator=(const _zgbmatrix&amp;)"</span>
00007             &lt;&lt; std::endl;
00008 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00009 <span class="preprocessor"></span>  
00010   <a class="code" href="classzgbmatrix.html#a16">shallow_copy</a>(mat);
00011   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00012 }
00013 <span class="comment"></span>
00014 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00015 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00016 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00017 <span class="comment"></span>
00018 <span class="comment">//=============================================================================</span><span class="comment"></span>
00019 <span class="comment">/*! zgbmatrix+=_zgbmatrix operator\n</span>
00020 <span class="comment">  If the band width of the left side matrix is narrower than the right side matrix, the band width of the left side matrix become thicker as same as the right side matrix. */</span>
<a name="l00021"></a><a class="code" href="classzgbmatrix.html#a25">00021</a> <span class="keyword">inline</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; <a class="code" href="classzgbmatrix.html#a21">zgbmatrix::operator+=</a>(<span class="keyword">const</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a>&amp; mat)
00022 {
00023 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00024 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zgbmatrix::operator+=(const _zgbmatrix&amp;)"</span>
00025             &lt;&lt; std::endl;
00026 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00027 <span class="preprocessor"></span>  
00028 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00029 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r1">N</a>!=mat.N || <a class="code" href="classzgbmatrix.html#r0">M</a>!=mat.M){
00030     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] zgbmatrix::operator+=(_zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00031               &lt;&lt; <span class="stringliteral">"These two matrises can not make a summation."</span> &lt;&lt; std::endl
00032               &lt;&lt; <span class="stringliteral">"Your input was"</span>
00033               &lt;&lt; <span class="stringliteral">"("</span> &lt;&lt; <a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt;<span class="stringliteral">"x"</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt;<span class="stringliteral">","</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r2">KL</a> &lt;&lt;<span class="stringliteral">":"</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r3">KU</a> &lt;&lt; <span class="stringliteral">") "</span>&lt;&lt; <span class="stringliteral">"+="</span>
00034               &lt;&lt; <span class="stringliteral">"("</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt;<span class="stringliteral">"x"</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt;<span class="stringliteral">","</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r2">KL</a> &lt;&lt;<span class="stringliteral">":"</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r3">KU</a> &lt;&lt;<span class="stringliteral">") "</span>
00035               &lt;&lt; std::endl;
00036     exit(1);
00037   }
00038 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00039 <span class="preprocessor"></span>  
00040   <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r2">KL</a>&gt;=mat.KL &amp;&amp; <a class="code" href="classzgbmatrix.html#r3">KU</a>&gt;=mat.KU){
00041     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzgbmatrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzgbmatrix.html#r0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00042       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-mat.KL); j&lt;min(<a class="code" href="classzgbmatrix.html#r1">N</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+mat.KU+1); j++){
00043         <a class="code" href="classzgbmatrix.html#a6">operator()</a>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00044       }
00045     }
00046     
00047     mat.destroy();
00048     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00049   }
00050   <span class="keywordflow">else</span>{
00051     <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat(<a class="code" href="classzgbmatrix.html#r0">M</a>,<a class="code" href="classzgbmatrix.html#r1">N</a>,max(<a class="code" href="classzgbmatrix.html#r2">KL</a>,mat.KL),max(<a class="code" href="classzgbmatrix.html#r3">KU</a>,mat.KU));
00052     newmat.<a class="code" href="classzgbmatrix.html#a12">zero</a>();
00053     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzgbmatrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzgbmatrix.html#r0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00054       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-<a class="code" href="classzgbmatrix.html#r2">KL</a>); j&lt;min(<a class="code" href="classzgbmatrix.html#r1">N</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+<a class="code" href="classzgbmatrix.html#r3">KU</a>+1); j++){
00055         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=<a class="code" href="classzgbmatrix.html#a6">operator()</a>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00056       }
00057       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-mat.KL); j&lt;min(mat.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+mat.KU+1); j++){
00058         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00059       }
00060     }
00061     
00062     <a class="code" href="classzgbmatrix.html#n10">swap</a>(*<span class="keyword">this</span>,newmat);
00063     mat.destroy();
00064     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00065   }
00066 }
00067 
00068 <span class="comment">//=============================================================================</span><span class="comment"></span>
00069 <span class="comment">/*! zgbmatrix-=_zgbmatrix operator\n</span>
00070 <span class="comment">  If the band width of the left side matrix is narrower than the right side matrix, the band width of the left side matrix become thicker as same as the right side matrix. */</span>
<a name="l00071"></a><a class="code" href="classzgbmatrix.html#a26">00071</a> <span class="keyword">inline</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; <a class="code" href="classzgbmatrix.html#a22">zgbmatrix::operator-=</a>(<span class="keyword">const</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a>&amp; mat)
00072 {
00073 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00074 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zgbmatrix::operator-=(const _zgbmatrix&amp;)"</span>
00075             &lt;&lt; std::endl;
00076 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00077 <span class="preprocessor"></span>  
00078 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00079 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r1">N</a>!=mat.N || <a class="code" href="classzgbmatrix.html#r0">M</a>!=mat.M){
00080     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] zgbmatrix::operator-=(_zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00081               &lt;&lt; <span class="stringliteral">"These two matrises can not make a subtraction."</span> &lt;&lt; std::endl
00082               &lt;&lt; <span class="stringliteral">"Your input was"</span>
00083               &lt;&lt; <span class="stringliteral">"("</span> &lt;&lt; <a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt;<span class="stringliteral">"x"</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt;<span class="stringliteral">","</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r2">KL</a> &lt;&lt;<span class="stringliteral">":"</span>&lt;&lt; <a class="code" href="classzgbmatrix.html#r3">KU</a> &lt;&lt; <span class="stringliteral">") "</span>&lt;&lt; <span class="stringliteral">"-="</span>
00084               &lt;&lt; <span class="stringliteral">"("</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt;<span class="stringliteral">"x"</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt;<span class="stringliteral">","</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r2">KL</a> &lt;&lt;<span class="stringliteral">":"</span>&lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r3">KU</a> &lt;&lt;<span class="stringliteral">") "</span>
00085               &lt;&lt; std::endl;
00086     exit(1);
00087   }
00088 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00089 <span class="preprocessor"></span>  
00090   <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r2">KL</a>&gt;=mat.KL &amp;&amp; <a class="code" href="classzgbmatrix.html#r3">KU</a>&gt;=mat.KU){
00091     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzgbmatrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzgbmatrix.html#r0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00092       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-mat.KL); j&lt;min(<a class="code" href="classzgbmatrix.html#r1">N</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+mat.KU+1); j++){
00093         <a class="code" href="classzgbmatrix.html#a6">operator()</a>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)-=mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00094       }
00095     }
00096     
00097     mat.destroy();
00098     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00099   }
00100   <span class="keywordflow">else</span>{
00101     <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat(<a class="code" href="classzgbmatrix.html#r0">M</a>,<a class="code" href="classzgbmatrix.html#r1">N</a>,max(<a class="code" href="classzgbmatrix.html#r2">KL</a>,mat.KL),max(<a class="code" href="classzgbmatrix.html#r3">KU</a>,mat.KU));
00102     newmat.<a class="code" href="classzgbmatrix.html#a12">zero</a>();
00103     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzgbmatrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzgbmatrix.html#r0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00104       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-<a class="code" href="classzgbmatrix.html#r2">KL</a>); j&lt;min(<a class="code" href="classzgbmatrix.html#r1">N</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+<a class="code" href="classzgbmatrix.html#r3">KU</a>+1); j++){
00105         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=<a class="code" href="classzgbmatrix.html#a6">operator()</a>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00106       }
00107       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-mat.KL); j&lt;min(mat.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+mat.KU+1); j++){
00108         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)-=mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00109       }
00110     }
00111     
00112     <a class="code" href="classzgbmatrix.html#n10">swap</a>(*<span class="keyword">this</span>,newmat);
00113     mat.destroy();
00114     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00115   }
00116 }
00117 
00118 <span class="comment">//=============================================================================</span><span class="comment"></span>
00119 <span class="comment">/*! zgbmatrix*=_zgbmatrix operator */</span>
<a name="l00120"></a><a class="code" href="classzgbmatrix.html#a27">00120</a> <span class="keyword">inline</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; <a class="code" href="classzgbmatrix.html#a23">zgbmatrix::operator*=</a>(<span class="keyword">const</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a>&amp; mat)
00121 {
00122 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00123 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zgbmatrix::operator*=(const _zgbmatrix&amp;)"</span>
00124             &lt;&lt; std::endl;
00125 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00126 <span class="preprocessor"></span>  
00127 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00128 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classzgbmatrix.html#r1">N</a>!=mat.M){
00129     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] zgbmatrix::operator*=(_zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00130               &lt;&lt; <span class="stringliteral">"These two matrises can not make a product."</span> &lt;&lt; std::endl
00131               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">") * ("</span>
00132               &lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; mat.<a class="code" href="classzgbmatrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00133     exit(1);
00134   }
00135 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00136 <span class="preprocessor"></span>  
00137   <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat( <a class="code" href="classzgbmatrix.html#r0">M</a>, mat.N, <a class="code" href="classzgbmatrix.html#r3">KU</a>+mat.KL-1, <a class="code" href="classzgbmatrix.html#r2">KL</a>+mat.KU+1 );
00138   newmat.<a class="code" href="classzgbmatrix.html#a12">zero</a>();
00139   
00140   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzgbmatrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;newmat.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00141     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-newmat.KL); j&lt;min(newmat.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+newmat.KU+1); j++){
00142       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> k=max( max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-<a class="code" href="classzgbmatrix.html#r2">KL</a>), max(0,j-mat.KU) );
00143           k&lt; min( min(<a class="code" href="classzgbmatrix.html#r1">N</a>,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+<a class="code" href="classzgbmatrix.html#r3">KU</a>+1), min(mat.M,j+mat.KL+1) ); k++){
00144         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+= <a class="code" href="classzgbmatrix.html#a6">operator()</a>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,k)*mat(k,j);
00145       }
00146     }
00147   }
00148   
00149   <a class="code" href="classzgbmatrix.html#n10">swap</a>(*<span class="keyword">this</span>,newmat);
00150   mat.destroy();
00151   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00152 }
00153 <span class="comment"></span>
00154 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00155 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00156 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00157 <span class="comment"></span>
00158 <span class="comment">//=============================================================================</span><span class="comment"></span>
00159 <span class="comment">/*! zgbmatrix+_zgbmatrix operator */</span>
<a name="l00160"></a><a class="code" href="zgbmatrix-__zgbmatrix_8hpp.html#a0">00160</a> <span class="keyword">inline</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a> <a class="code" href="__dcovector-__dcovector_8hpp.html#a0">operator+</a>(<span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; matA, <span class="keyword">const</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a>&amp; matB)
00161 {
00162 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00163 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] operator+(const zgbmatrix&amp;, const _zgbmatrix&amp;)"</span>
00164             &lt;&lt; std::endl;
00165 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00166 <span class="preprocessor"></span>  
00167 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00168 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(matA.N!=matB.N || matA.M!=matB.M){
00169     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] operator+(zgbmatrix&amp;, _zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00170               &lt;&lt; <span class="stringliteral">"These two matrises can not make a summation."</span> &lt;&lt; std::endl
00171               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; matA.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matA.N &lt;&lt; <span class="stringliteral">") + ("</span>
00172               &lt;&lt; matB.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.N &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00173     exit(1);
00174   }
00175 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00176 <span class="preprocessor"></span>  
00177   <span class="keywordflow">if</span>(matB.KL&gt;matA.KL &amp;&amp; matB.KU&gt;matA.KU){
00178     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;matA.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00179       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matA.KL); j&lt;min(matA.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matA.KU+1); j++){
00180         matB(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=matA(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00181       }
00182     }
00183     
00184     <span class="keywordflow">return</span> matB;
00185   }
00186   <span class="keywordflow">else</span>{
00187     <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat(matA.M,matA.N,max(matA.KL,matB.KL),max(matA.KU,matB.KU));
00188     newmat.zero();
00189     
00190     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;matA.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00191       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matA.KL); j&lt;min(matA.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matA.KU+1); j++){
00192         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=matA(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00193       }
00194       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matB.KL); j&lt;min(matB.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matB.KU+1); j++){
00195         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=matB(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00196       }
00197     }
00198     
00199     matB.<a class="code" href="class__dcovector.html#a6">destroy</a>();
00200     <span class="keywordflow">return</span> <a class="code" href="dcovector-misc_8hpp.html#a1">_</a>(newmat);
00201   }
00202 }
00203 
00204 <span class="comment">//=============================================================================</span><span class="comment"></span>
00205 <span class="comment">/*! zgbmatrix-_zgbmatrix operator */</span>
<a name="l00206"></a><a class="code" href="zgbmatrix-__zgbmatrix_8hpp.html#a1">00206</a> <span class="keyword">inline</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a> <a class="code" href="__dcovector-__dcovector_8hpp.html#a1">operator-</a>(<span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; matA, <span class="keyword">const</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a>&amp; matB)
00207 {
00208 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00209 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] operator-(const zgbmatrix&amp;, const _zgbmatrix&amp;)"</span>
00210             &lt;&lt; std::endl;
00211 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00212 <span class="preprocessor"></span>  
00213 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00214 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(matA.N!=matB.N || matA.M!=matB.M){
00215     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] operator-(zgbmatrix&amp;, _zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00216               &lt;&lt; <span class="stringliteral">"These two matrises can not make a subtraction."</span> &lt;&lt; std::endl
00217               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; matA.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matA.N &lt;&lt; <span class="stringliteral">") - ("</span>
00218               &lt;&lt; matB.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.N &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00219     exit(1);
00220   }
00221 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00222 <span class="preprocessor"></span>  
00223   <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat(matA.M,matA.N,max(matA.KL,matB.KL),max(matA.KU,matB.KU));
00224   newmat.zero();
00225   
00226   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;matA.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00227     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matA.KL); j&lt;min(matA.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matA.KU+1); j++){
00228       newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+=matA(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00229     }
00230     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matB.KL); j&lt;min(matB.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matB.KU+1); j++){
00231       newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)-=matB(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00232     }
00233   }
00234   
00235   matB.<a class="code" href="class__dcovector.html#a6">destroy</a>();
00236   <span class="keywordflow">return</span> <a class="code" href="dcovector-misc_8hpp.html#a1">_</a>(newmat);
00237 }
00238 
00239 <span class="comment">//=============================================================================</span><span class="comment"></span>
00240 <span class="comment">/*! zgbmatrix*_zgbmatrix operator */</span>
<a name="l00241"></a><a class="code" href="zgbmatrix-__zgbmatrix_8hpp.html#a2">00241</a> <span class="keyword">inline</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a> <a class="code" href="__dcovector-__drovector_8hpp.html#a0">operator*</a>(<span class="keyword">const</span> <a class="code" href="classzgbmatrix.html">zgbmatrix</a>&amp; matA, <span class="keyword">const</span> <a class="code" href="class__zgbmatrix.html">_zgbmatrix</a>&amp; matB)
00242 {
00243 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00244 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] operator*(const zgbmatrix&amp;, const _zgbmatrix&amp;)"</span>
00245             &lt;&lt; std::endl;
00246 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00247 <span class="preprocessor"></span>  
00248 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00249 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(matA.N!=matB.M){
00250     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] operator*(zgbmatrix&amp;, _zgbmatrix&amp;)"</span> &lt;&lt; std::endl
00251               &lt;&lt; <span class="stringliteral">"These two matrises can not make a product."</span> &lt;&lt; std::endl
00252               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; matA.<a class="code" href="class__dgematrix.html#o0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matA.<a class="code" href="class__dgematrix.html#o1">N</a> &lt;&lt; <span class="stringliteral">") * ("</span>
00253               &lt;&lt; matB.<a class="code" href="class__dgematrix.html#o0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.<a class="code" href="class__dgematrix.html#o1">N</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00254     exit(1);
00255   }
00256 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00257 <span class="preprocessor"></span>  
00258   <a class="code" href="classzgbmatrix.html">zgbmatrix</a> newmat( matA.M, matB.N, matA.KU+matB.KL-1, matA.KL+matB.KU+1 );
00259   newmat.zero();
00260   
00261   <span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>, j, k;
00262 <span class="preprocessor">#pragma omp parallel for private(j,k)</span>
00263 <span class="preprocessor"></span>  <span class="keywordflow">for</span>(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;newmat.m; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00264     <span class="keywordflow">for</span>(j=max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-newmat.kl); j&lt;min(newmat.n,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+newmat.ku+1); j++){
00265       <span class="keywordflow">for</span>(k=max( max(0,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>-matA.KL), max(0,j-matB.KU) );
00266           k&lt; min( min(matA.N,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+matA.KU+1), min(matB.M,j+matB.KL+1) ); k++){
00267         newmat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)+= matA(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,k)*matB(k,j);
00268       }
00269     }
00270   }
00271   
00272   matB.<a class="code" href="class__dgematrix.html#a6">destroy</a>();
00273   <span class="keywordflow">return</span> <a class="code" href="dcovector-misc_8hpp.html#a1">_</a>(newmat);
00274 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Mar 25 17:28:24 2005 for CPPLapack by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
