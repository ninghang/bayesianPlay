<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CPPLapack: zhematrix-lapack.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href="dir_000027.html">zhematrix-</a></div>
<h1>zhematrix-lapack.hpp</h1><a href="zhematrix-lapack_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">//=============================================================================</span><span class="comment"></span>
00002 <span class="comment">/*! solve A*X=Y using zhesv\n</span>
00003 <span class="comment">  The argument is dmatrix Y. Y is overwritten and become the solution X.</span>
00004 <span class="comment">  A is also overwritten. </span>
00005 <span class="comment">*/</span>
<a name="l00006"></a><a class="code" href="classzhematrix.html#a21">00006</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#a21">zhematrix::zhesv</a>(<a class="code" href="classzgematrix.html">zgematrix</a>&amp; mat)
00007 {
00008 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00009 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::zhesv(zgematrix&amp;)"</span>
00010             &lt;&lt; std::endl;
00011 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00012 <span class="preprocessor"></span>  
00013 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00014 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classzhematrix.html#r0">N</a>!=mat.N){
00015     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] zhematrix::zhesv(zgematrix&amp;) "</span> &lt;&lt; std::endl
00016               &lt;&lt; <span class="stringliteral">"These two matrices cannot be solved."</span> &lt;&lt; std::endl
00017               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classzhematrix.html#r0">N</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classzhematrix.html#r0">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00018               &lt;&lt; mat.N &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; mat.N &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00019     exit(1);
00020   }
00021 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00022 <span class="preprocessor"></span>  
00023   <span class="keywordtype">char</span> UPLO(<span class="charliteral">'L'</span>);
00024   <span class="keywordtype">long</span> NRHS(mat.N), LDA(<a class="code" href="classzhematrix.html#r0">N</a>), *IPIV(<span class="keyword">new</span> <span class="keywordtype">long</span>[<a class="code" href="classzhematrix.html#r0">N</a>]), LDB(mat.N), LWORK(-1), INFO(1);
00025   std::complex&lt;double&gt; *WORK(<span class="keyword">new</span> std::complex&lt;double&gt;[1]);
00026   zhesv_(UPLO, N, NRHS, <a class="code" href="classzhematrix.html#r1">Array</a>, LDA, IPIV, mat.Array, LDB, WORK, LWORK, INFO);
00027   
00028   INFO=1;
00029   LWORK = long(std::real(WORK[0]));
00030   <span class="keyword">delete</span> [] WORK;  WORK =<span class="keyword">new</span> std::complex&lt;double&gt;[LWORK];
00031   zhesv_(UPLO, N, NRHS, <a class="code" href="classzhematrix.html#r1">Array</a>, LDA, IPIV, mat.Array, LDB, WORK, LWORK, INFO);
00032   <span class="keyword">delete</span> [] WORK; <span class="keyword">delete</span> [] IPIV;
00033   
00034   <span class="keywordflow">if</span>(INFO!=0){
00035     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] zhematrix::zhesv(zhematrix&amp;) "</span>
00036               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00037               &lt;&lt; std::endl;
00038   }
00039   <span class="keywordflow">return</span> INFO;
00040 }
00041 
00042 <span class="comment">//=============================================================================</span><span class="comment"></span>
00043 <span class="comment">/*! solve A*x=y using zhesv\n</span>
00044 <span class="comment">  The argument is zcovector y. y is overwritten and become the solution x.</span>
00045 <span class="comment">  A is also overwritten.</span>
00046 <span class="comment">*/</span>
<a name="l00047"></a><a class="code" href="classzhematrix.html#a22">00047</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#a21">zhematrix::zhesv</a>(<a class="code" href="classzcovector.html">zcovector</a>&amp; vec)
00048 {
00049 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00050 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::zhesv(zcovector&amp;)"</span>
00051             &lt;&lt; std::endl;
00052 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00053 <span class="preprocessor"></span>  
00054 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00055 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classzhematrix.html#r0">N</a>!=vec.L){
00056     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] zhematrix::zhesv(zcovector&amp;) "</span> &lt;&lt; std::endl
00057               &lt;&lt; <span class="stringliteral">"These matrix and vector cannot be solved."</span> &lt;&lt; std::endl
00058               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classzhematrix.html#r0">N</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classzhematrix.html#r0">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00059               &lt;&lt; vec.L &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00060     exit(1);
00061   }
00062 <span class="preprocessor">#endif//CPPL_DEBUG </span>
00063 <span class="preprocessor"></span>  
00064   <span class="keywordtype">char</span> UPLO(<span class="charliteral">'L'</span>);
00065   <span class="keywordtype">long</span> NRHS(1), LDA(<a class="code" href="classzhematrix.html#r0">N</a>), *IPIV(<span class="keyword">new</span> <span class="keywordtype">long</span>[<a class="code" href="classzhematrix.html#r0">N</a>]), LDB(vec.L), LWORK(-1), INFO(1);
00066   std::complex&lt;double&gt; *WORK( <span class="keyword">new</span> std::complex&lt;double&gt;[1] );
00067   zhesv_(UPLO, N, NRHS, <a class="code" href="classzhematrix.html#r1">Array</a>, LDA, IPIV, vec.Array, LDB, WORK, LWORK, INFO);
00068   
00069   INFO=1;
00070   LWORK = long(std::real(WORK[0]));
00071   <span class="keyword">delete</span> WORK;  WORK = <span class="keyword">new</span> std::complex&lt;double&gt;[LWORK];
00072   zhesv_(UPLO, N, NRHS, <a class="code" href="classzhematrix.html#r1">Array</a>, LDA, IPIV, vec.Array, LDB, WORK, LWORK, INFO);
00073   <span class="keyword">delete</span> [] WORK;  <span class="keyword">delete</span> [] IPIV;
00074   
00075   <span class="keywordflow">if</span>(INFO!=0){
00076     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] zhematrix::zhesv(zcovector&amp;) "</span>
00077               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00078               &lt;&lt; std::endl;
00079   }
00080   <span class="keywordflow">return</span> INFO;
00081 }
00082 <span class="comment"></span>
00083 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00084 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00085 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00086 <span class="comment"></span>
00087 <span class="comment">//=============================================================================</span><span class="comment"></span>
00088 <span class="comment">/*! calculate eigenvalues and eigenvectors.\n</span>
00089 <span class="comment">  All of the arguments need not to be initialized.</span>
00090 <span class="comment">  w is overwitten and become eigenvalues.</span>
00091 <span class="comment">  This matrix is also overwritten. </span>
00092 <span class="comment">  if jobz=1, this matrix becomes eigenvectors.</span>
00093 <span class="comment">*/</span>
<a name="l00094"></a><a class="code" href="classzhematrix.html#a23">00094</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#a23">zhematrix::zheev</a>(std::vector&lt;double&gt;&amp; w,
00095                              <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; jobz=0)
00096 {
00097 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00098 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::zheev(std::vector&lt;double&gt;&amp;, const bool&amp;)"</span>
00099             &lt;&lt; std::endl;
00100 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00101 <span class="preprocessor"></span>  
00102   w.resize(<a class="code" href="classzhematrix.html#r0">N</a>);
00103   <span class="keywordtype">char</span> JOBZ, UPLO(<span class="charliteral">'L'</span>);
00104   <span class="keywordflow">if</span>(jobz==0){ JOBZ=<span class="charliteral">'N'</span>; } <span class="keywordflow">else</span>{ JOBZ=<span class="charliteral">'V'</span>; }
00105   <span class="keywordtype">long</span> LDA(<a class="code" href="classzhematrix.html#r0">N</a>), INFO(1), LWORK(-1);
00106   <span class="keywordtype">double</span> *RWORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[max(1, 3*<a class="code" href="classzhematrix.html#r0">N</a>-2)]);
00107   std::complex&lt;double&gt; *WORK(<span class="keyword">new</span> std::complex&lt;double&gt;[1]);
00108   zheev_(JOBZ, UPLO, <a class="code" href="classzhematrix.html#r0">N</a>, <a class="code" href="classzhematrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, RWORK, INFO);
00109   
00110   INFO=1;
00111   LWORK = long(std::real(WORK[0]));
00112   <span class="keyword">delete</span> [] WORK;  WORK = <span class="keyword">new</span> std::complex&lt;double&gt;[LWORK];
00113   zheev_(JOBZ, UPLO, <a class="code" href="classzhematrix.html#r0">N</a>, <a class="code" href="classzhematrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, RWORK, INFO);
00114   <span class="keyword">delete</span> [] RWORK;  <span class="keyword">delete</span> [] WORK;
00115   
00116   <span class="keywordflow">if</span>(INFO!=0){
00117     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] zhematrix::zheev"</span>
00118               &lt;&lt; <span class="stringliteral">"(vector&lt;std::complex&lt;double&gt;&gt;&amp;, const bool&amp;) "</span>
00119               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00120               &lt;&lt; std::endl;
00121   }
00122   <span class="keywordflow">return</span> INFO;
00123 }
00124 
00125 <span class="comment">//=============================================================================</span><span class="comment"></span>
00126 <span class="comment">/*! calculate eigenvalues and eigenvectors.\n</span>
00127 <span class="comment">  All of the arguments need not to be initialized.</span>
00128 <span class="comment">  w and v are overwitten and become </span>
00129 <span class="comment">  eigenvalues and eigenvectors, respectively.</span>
00130 <span class="comment">  This matrix is also overwritten. </span>
00131 <span class="comment">*/</span>
<a name="l00132"></a><a class="code" href="classzhematrix.html#a24">00132</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#a23">zhematrix::zheev</a>(std::vector&lt;double&gt;&amp; w,
00133                              std::vector&lt;zcovector&gt;&amp; v)
00134 {
00135 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00136 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::zheev(std::vector&lt;double&gt;&amp;, std::vector&lt;zcovector&gt;&amp;)"</span>
00137             &lt;&lt; std::endl;
00138 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00139 <span class="preprocessor"></span>  
00140   w.resize(<a class="code" href="classzhematrix.html#r0">N</a>);  v.resize(<a class="code" href="classzhematrix.html#r0">N</a>);
00141   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzhematrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ v[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].resize(N); }
00142   <span class="keywordtype">char</span> JOBZ(<span class="charliteral">'V'</span>), UPLO(<span class="charliteral">'L'</span>);
00143   <span class="keywordtype">long</span> LDA(N), INFO(1), LWORK(-1);
00144   <span class="keywordtype">double</span> *RWORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[max(1, 3*N-2)]);
00145   std::complex&lt;double&gt; *WORK(<span class="keyword">new</span> std::complex&lt;double&gt;[1]);
00146   zheev_(JOBZ, UPLO, N, <a class="code" href="classzhematrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, RWORK, INFO);
00147   
00148   INFO=1;
00149   LWORK = long(std::real(WORK[0]));
00150   <span class="keyword">delete</span> [] WORK;  WORK = <span class="keyword">new</span> std::complex&lt;double&gt;[LWORK];
00151   zheev_(JOBZ, UPLO, N, <a class="code" href="classzhematrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, RWORK, INFO);
00152   <span class="keyword">delete</span> [] RWORK;  <span class="keyword">delete</span> [] WORK;
00153   <span class="comment"></span>
00154 <span class="comment">  //// forming ////</span>
00155 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;N; j++){
00156     v[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = <a class="code" href="classzhematrix.html#r1">Array</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+N*j];
00157   }}
00158   
00159   <span class="keywordflow">if</span>(INFO!=0){
00160     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] zhematrix::zheev"</span>
00161               &lt;&lt; <span class="stringliteral">"(vector&lt;std::complex&lt;double&gt;&gt;&amp;, vector&lt;zcovector&gt;&amp;) "</span>
00162               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00163               &lt;&lt; std::endl;
00164   }
00165   <span class="keywordflow">return</span> INFO;
00166 }
00167 
00168 <span class="comment">//=============================================================================</span><span class="comment"></span>
00169 <span class="comment">/*! calculate eigenvalues and eigenvectors.\n</span>
00170 <span class="comment">  All of the arguments need not to be initialized.</span>
00171 <span class="comment">  w and v are overwitten and become </span>
00172 <span class="comment">  eigenvalues and eigenvectors, respectively.</span>
00173 <span class="comment">  This matrix is also overwritten. </span>
00174 <span class="comment">*/</span>
<a name="l00175"></a><a class="code" href="classzhematrix.html#a25">00175</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#a23">zhematrix::zheev</a>(std::vector&lt;double&gt;&amp; w,
00176                              std::vector&lt;zrovector&gt;&amp; v)
00177 {
00178 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00179 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] zhematrix::zheev(std::vector&lt;double&gt;&amp;, std::vector&lt;zrovector&gt;&amp;)"</span>
00180             &lt;&lt; std::endl;
00181 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00182 <span class="preprocessor"></span>  
00183   w.resize(<a class="code" href="classzhematrix.html#r0">N</a>);  v.resize(<a class="code" href="classzhematrix.html#r0">N</a>);
00184   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classzhematrix.html#n13">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classzhematrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ v[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].resize(N); }
00185   <span class="keywordtype">char</span> JOBZ(<span class="charliteral">'V'</span>), UPLO(<span class="charliteral">'L'</span>);
00186   <span class="keywordtype">long</span> LDA(N), INFO(1), LWORK(-1);
00187   <span class="keywordtype">double</span> *RWORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[max(1, 3*N-2)]);
00188   std::complex&lt;double&gt; *WORK(<span class="keyword">new</span> std::complex&lt;double&gt;[1]);
00189   zheev_(JOBZ, UPLO, N, <a class="code" href="classzhematrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, RWORK, INFO);
00190   
00191   INFO=1;
00192   LWORK = long(std::real(WORK[0]));
00193   <span class="keyword">delete</span> [] WORK;  WORK = <span class="keyword">new</span> std::complex&lt;double&gt;[LWORK];
00194   zheev_(JOBZ, UPLO, N, <a class="code" href="classzhematrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, RWORK, INFO);
00195   <span class="keyword">delete</span> [] RWORK;  <span class="keyword">delete</span> [] WORK;
00196   <span class="comment"></span>
00197 <span class="comment">  //// forming ////</span>
00198 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;N; j++){
00199     v[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = <a class="code" href="classzhematrix.html#r1">Array</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+N*j];
00200   }}
00201   
00202   <span class="keywordflow">if</span>(INFO!=0){
00203     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] zhematrix::zheev"</span>
00204               &lt;&lt; <span class="stringliteral">"(vector&lt;std::complex&lt;double&gt;&gt;&amp;, vector&lt;zcovector&gt;&amp;)"</span>
00205               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00206               &lt;&lt; std::endl;
00207   }
00208   <span class="keywordflow">return</span> INFO;
00209 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Mar 25 17:28:24 2005 for CPPLapack by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
