<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CPPLapack: dsymatrix-lapack.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href="dir_000021.html">dsymatrix-</a></div>
<h1>dsymatrix-lapack.hpp</h1><a href="dsymatrix-lapack_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">//=============================================================================</span><span class="comment"></span>
00002 <span class="comment">/*! solve A*X=Y using dsysv\n</span>
00003 <span class="comment">  The argument is dmatrix Y. Y is overwritten and become the solution X.</span>
00004 <span class="comment">  A is also overwritten. </span>
00005 <span class="comment">*/</span>
<a name="l00006"></a><a class="code" href="classdsymatrix.html#a22">00006</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdsymatrix.html#a22">dsymatrix::dsysv</a>(<a class="code" href="classdgematrix.html">dgematrix</a>&amp; mat)
00007 {
00008 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00009 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dsymatrix::dsysv(dgematrix&amp;)"</span>
00010             &lt;&lt; std::endl;
00011 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00012 <span class="preprocessor"></span>  
00013 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00014 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdsymatrix.html#r0">N</a>!=mat.N){
00015     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dsymatrix::dsysv(dgematrix&amp;) "</span> &lt;&lt; std::endl
00016               &lt;&lt; <span class="stringliteral">"These two matrices cannot be solved."</span> &lt;&lt; std::endl
00017               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classdsymatrix.html#r0">N</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdsymatrix.html#r0">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00018               &lt;&lt; mat.N &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; mat.N &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00019     exit(1);
00020   }
00021 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00022 <span class="preprocessor"></span>  
00023   <span class="keywordtype">char</span> UPLO(<span class="charliteral">'L'</span>);
00024   <span class="keywordtype">long</span> NRHS(mat.N), LDA(<a class="code" href="classdsymatrix.html#r0">N</a>), *IPIV(<span class="keyword">new</span> <span class="keywordtype">long</span>[<a class="code" href="classdsymatrix.html#r0">N</a>]), LDB(mat.N), LWORK(-1), INFO(1);
00025   <span class="keywordtype">double</span> *WORK( <span class="keyword">new</span> <span class="keywordtype">double</span>[1] );
00026   dsysv_(UPLO, N, NRHS, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, IPIV, mat.Array, LDB, WORK, LWORK, INFO);
00027   
00028   INFO=1; 
00029   LWORK = long(WORK[0]);
00030   <span class="keyword">delete</span> [] WORK;  WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK];
00031   dsysv_(UPLO, N, NRHS, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, IPIV, mat.Array, LDB, WORK, LWORK, INFO);
00032   <span class="keyword">delete</span> [] WORK; <span class="keyword">delete</span> [] IPIV;
00033   
00034   <span class="keywordflow">if</span>(INFO!=0){
00035     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dsymatrix::dsysv(dsymatrix&amp;) "</span>
00036               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00037               &lt;&lt; std::endl;
00038   }
00039   <span class="keywordflow">return</span> INFO;
00040 }
00041 
00042 <span class="comment">//=============================================================================</span><span class="comment"></span>
00043 <span class="comment">/*! solve A*x=y using dsysv\n</span>
00044 <span class="comment">  The argument is dcovector y. y is overwritten and become the solution x.</span>
00045 <span class="comment">  A is also overwritten.</span>
00046 <span class="comment">*/</span>
<a name="l00047"></a><a class="code" href="classdsymatrix.html#a23">00047</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdsymatrix.html#a22">dsymatrix::dsysv</a>(<a class="code" href="classdcovector.html">dcovector</a>&amp; vec)
00048 {
00049 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00050 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dsymatrix::dsysv(dcovector&amp;)"</span>
00051             &lt;&lt; std::endl;
00052 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00053 <span class="preprocessor"></span>  
00054 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00055 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdsymatrix.html#r0">N</a>!=vec.L){
00056     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dsymatrix::dsysv(dcovector&amp;) "</span> &lt;&lt; std::endl
00057               &lt;&lt; <span class="stringliteral">"These matrix and vector cannot be solved."</span> &lt;&lt; std::endl
00058               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classdsymatrix.html#r0">N</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdsymatrix.html#r0">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00059               &lt;&lt; vec.L &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00060     exit(1);
00061   }
00062 <span class="preprocessor">#endif//CPPL_DEBUG </span>
00063 <span class="preprocessor"></span>  
00064   <span class="keywordtype">char</span> UPLO(<span class="charliteral">'L'</span>);
00065   <span class="keywordtype">long</span> NRHS(1), LDA(<a class="code" href="classdsymatrix.html#r0">N</a>), *IPIV(<span class="keyword">new</span> <span class="keywordtype">long</span>[<a class="code" href="classdsymatrix.html#r0">N</a>]), LDB(vec.L), LWORK(-1), INFO(1);
00066   <span class="keywordtype">double</span> *WORK( <span class="keyword">new</span> <span class="keywordtype">double</span>[1] );
00067   dsysv_(UPLO, N, NRHS, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, IPIV, vec.Array, LDB, WORK, LWORK, INFO);
00068   
00069   INFO=1;
00070   LWORK = long(WORK[0]);
00071   <span class="keyword">delete</span> WORK;  WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK];
00072   dsysv_(UPLO, N, NRHS, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, IPIV, vec.Array, LDB, WORK, LWORK, INFO);
00073   <span class="keyword">delete</span> [] WORK;  <span class="keyword">delete</span> [] IPIV;
00074 
00075   <span class="keywordflow">if</span>(INFO!=0){
00076     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dsymatrix::dsysv(dcovector&amp;) "</span>
00077               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00078               &lt;&lt; std::endl;
00079   }
00080   <span class="keywordflow">return</span> INFO;
00081 }
00082 <span class="comment"></span>
00083 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00084 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00085 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00086 <span class="comment"></span>
00087 <span class="comment">//=============================================================================</span><span class="comment"></span>
00088 <span class="comment">/*! calculate eigenvalues and eigenvectors.\n</span>
00089 <span class="comment">  All of the arguments need not to be initialized.</span>
00090 <span class="comment">  w is overwitten and become eigenvalues.</span>
00091 <span class="comment">  This matrix is also overwritten. </span>
00092 <span class="comment">  if jobz=1, this matrix becomes eigenvectors.</span>
00093 <span class="comment">*/</span>
<a name="l00094"></a><a class="code" href="classdsymatrix.html#a24">00094</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdsymatrix.html#a24">dsymatrix::dsyev</a>(std::vector&lt;double&gt;&amp; w, <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; jobz=0)
00095 {
00096 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00097 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dsymatrix::dsyev(std::vector&lt;double&gt;&amp;, const bool&amp;)"</span>
00098             &lt;&lt; std::endl;
00099 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00100 <span class="preprocessor"></span>  
00101   w.resize(<a class="code" href="classdsymatrix.html#r0">N</a>);
00102   <span class="keywordtype">char</span> JOBZ, UPLO(<span class="charliteral">'L'</span>);
00103   <span class="keywordflow">if</span>(jobz==0){ JOBZ=<span class="charliteral">'N'</span>; } <span class="keywordflow">else</span>{ JOBZ=<span class="charliteral">'V'</span>; }
00104   <span class="keywordtype">long</span> LDA(<a class="code" href="classdsymatrix.html#r0">N</a>), INFO(1), LWORK(-1);
00105   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[1]);
00106   dsyev_(JOBZ, UPLO, <a class="code" href="classdsymatrix.html#r0">N</a>, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, INFO);
00107   
00108   INFO=1;
00109   LWORK = long(WORK[0]);
00110   <span class="keyword">delete</span> [] WORK;  WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK];
00111   dsyev_(JOBZ, UPLO, <a class="code" href="classdsymatrix.html#r0">N</a>, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, INFO);
00112   <span class="keyword">delete</span> [] WORK;
00113   
00114   <span class="keywordflow">if</span>(INFO!=0){
00115     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dsymatrix::dsyev(vector&lt;double&gt;&amp;, const bool&amp;)"</span>
00116               &lt;&lt; std::endl
00117               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00118               &lt;&lt; std::endl;
00119   }
00120   <span class="keywordflow">return</span> INFO;
00121 }
00122 
00123 <span class="comment">//=============================================================================</span><span class="comment"></span>
00124 <span class="comment">/*! calculate eigenvalues and eigenvectors.\n</span>
00125 <span class="comment">  All of the arguments need not to be initialized.</span>
00126 <span class="comment">  w and v are overwitten and become </span>
00127 <span class="comment">  eigenvalues and eigenvectors, respectively.</span>
00128 <span class="comment">  This matrix is also overwritten. </span>
00129 <span class="comment">*/</span>
<a name="l00130"></a><a class="code" href="classdsymatrix.html#a25">00130</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdsymatrix.html#a24">dsymatrix::dsyev</a>(std::vector&lt;double&gt;&amp; w, std::vector&lt;dcovector&gt;&amp; v)
00131 {
00132 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00133 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dsymatrix::dsyev(std::vector&lt;double&gt;&amp;, std::vector&lt;dcovector&gt;&amp;)"</span>
00134             &lt;&lt; std::endl;
00135 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00136 <span class="preprocessor"></span>  
00137   w.resize(<a class="code" href="classdsymatrix.html#r0">N</a>);  v.resize(<a class="code" href="classdsymatrix.html#r0">N</a>);
00138   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdsymatrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classdsymatrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ v[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].resize(N); }
00139   <span class="keywordtype">char</span> JOBZ(<span class="charliteral">'V'</span>), UPLO(<span class="charliteral">'L'</span>);
00140   <span class="keywordtype">long</span> LDA(N), INFO(1), LWORK(-1);
00141   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[1]);
00142   dsyev_(JOBZ, UPLO, N, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, INFO);
00143   
00144   INFO=1;
00145   LWORK = long(WORK[0]);
00146   <span class="keyword">delete</span> [] WORK;  WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK];
00147   dsyev_(JOBZ, UPLO, N, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, INFO);
00148   <span class="keyword">delete</span> [] WORK;
00149   <span class="comment"></span>
00150 <span class="comment">  //// forming ////</span>
00151 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;N; j++){
00152     v[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = <a class="code" href="classdsymatrix.html#r1">Array</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+N*j];
00153   }}
00154   
00155   <span class="keywordflow">if</span>(INFO!=0){
00156     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dsymatrix::dsyev"</span>
00157               &lt;&lt; <span class="stringliteral">"(vector&lt;double&gt;&amp;, vector&lt;dcovector&gt;&amp;)"</span> &lt;&lt; std::endl
00158               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00159               &lt;&lt; std::endl;
00160   }
00161   <span class="keywordflow">return</span> INFO;
00162 }
00163 
00164 <span class="comment">//=============================================================================</span><span class="comment"></span>
00165 <span class="comment">/*! calculate eigenvalues and eigenvectors.\n</span>
00166 <span class="comment">  All of the arguments need not to be initialized.</span>
00167 <span class="comment">  w and v are overwitten and become </span>
00168 <span class="comment">  eigenvalues and eigenvectors, respectively.</span>
00169 <span class="comment">  This matrix is also overwritten. </span>
00170 <span class="comment">*/</span>
<a name="l00171"></a><a class="code" href="classdsymatrix.html#a26">00171</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdsymatrix.html#a24">dsymatrix::dsyev</a>(std::vector&lt;double&gt;&amp; w, std::vector&lt;drovector&gt;&amp; v)
00172 {
00173 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00174 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dsymatrix::dsyev(std::vector&lt;double&gt;&amp;, std::vector&lt;drovector&gt;&amp;)"</span>
00175             &lt;&lt; std::endl;
00176 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00177 <span class="preprocessor"></span>  
00178   w.resize(<a class="code" href="classdsymatrix.html#r0">N</a>);  v.resize(<a class="code" href="classdsymatrix.html#r0">N</a>);
00179   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdsymatrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classdsymatrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ v[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].resize(N); }
00180   <span class="keywordtype">char</span> JOBZ(<span class="charliteral">'V'</span>), UPLO(<span class="charliteral">'L'</span>);
00181   <span class="keywordtype">long</span> LDA(N), INFO(1), LWORK(-1);
00182   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[1]);
00183   dsyev_(JOBZ, UPLO, N, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, INFO);
00184   
00185   INFO=1;
00186   LWORK = long(WORK[0]);
00187   <span class="keyword">delete</span> [] WORK;  WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK];
00188   dsyev_(JOBZ, UPLO, N, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, &amp;w[0], WORK, LWORK, INFO);
00189   <span class="keyword">delete</span> [] WORK;
00190   <span class="comment"></span>
00191 <span class="comment">  //// forming ////</span>
00192 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;N; j++){
00193     v[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = <a class="code" href="classdsymatrix.html#r1">Array</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>+N*j];
00194   }}
00195   
00196   <span class="keywordflow">if</span>(INFO!=0){
00197     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dsymatrix::dsyev"</span>
00198               &lt;&lt; <span class="stringliteral">"(vector&lt;double&gt;&amp;, vector&lt;dcovector&gt;&amp;)"</span> &lt;&lt; std::endl
00199               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00200               &lt;&lt; std::endl;
00201   }
00202   <span class="keywordflow">return</span> INFO;
00203 }
00204 <span class="comment"></span>
00205 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00206 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00207 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00208 <span class="comment"></span>
00209 <span class="comment">//=============================================================================</span><span class="comment"></span>
00210 <span class="comment">/*! calculate generalized eigenvalues\n</span>
00211 <span class="comment">  w is overwitten and become generalized eigenvalues.</span>
00212 <span class="comment">  This matrix and matB are also overwritten. </span>
00213 <span class="comment">*/</span>
<a name="l00214"></a><a class="code" href="classdsymatrix.html#a27">00214</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdsymatrix.html#a27">dsymatrix::dsygv</a>(<a class="code" href="classdsymatrix.html">dsymatrix</a>&amp; matB, std::vector&lt;double&gt;&amp; w)
00215 {
00216 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00217 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dsymatrix::dsygv(dsymatrix&amp;, std::vector&lt;double&gt;&amp;)"</span>
00218             &lt;&lt; std::endl;
00219 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00220 <span class="preprocessor"></span>  
00221 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00222 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(matB.N!=<a class="code" href="classdsymatrix.html#r0">N</a>){
00223     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dsymatrix::dsygv"</span>
00224               &lt;&lt; <span class="stringliteral">"(dsymatrix&amp;, vector&lt;double&gt;&amp;) "</span> &lt;&lt; std::endl
00225               &lt;&lt; <span class="stringliteral">"The matrix B is not a matrix "</span>
00226               &lt;&lt; <span class="stringliteral">"having the same size as \"this\" matrix."</span> &lt;&lt; std::endl
00227               &lt;&lt; <span class="stringliteral">"The B matrix is ("</span> &lt;&lt; matB.N &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.N &lt;&lt; <span class="stringliteral">")."</span>
00228               &lt;&lt; std::endl;
00229     exit(1);
00230   }
00231 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00232 <span class="preprocessor"></span>  
00233   w.resize(<a class="code" href="classdsymatrix.html#r0">N</a>);
00234   <span class="keywordtype">char</span> JOBZ(<span class="charliteral">'N'</span>), UPLO(<span class="charliteral">'L'</span>);
00235   <span class="keywordtype">long</span> ITYPE(1), LDA(<a class="code" href="classdsymatrix.html#r0">N</a>), LDB(<a class="code" href="classdsymatrix.html#r0">N</a>), LWORK(-1), INFO(1);
00236   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[1]);
00237   dsygv_(ITYPE, JOBZ, UPLO, <a class="code" href="classdsymatrix.html#r0">N</a>, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, matB.Array, LDB, &amp;w[0],
00238          WORK, LWORK, INFO);
00239   INFO=1;
00240   LWORK = long(WORK[0]);
00241   <span class="keyword">delete</span> [] WORK;  WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK];
00242   dsygv_(ITYPE, JOBZ, UPLO, <a class="code" href="classdsymatrix.html#r0">N</a>, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, matB.Array, LDB, &amp;w[0],
00243          WORK, LWORK, INFO);
00244   <span class="keyword">delete</span> [] WORK;
00245   
00246   <span class="keywordflow">if</span>(INFO!=0){
00247     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dsymatrix::dsygv"</span>
00248               &lt;&lt; <span class="stringliteral">"(dsymatrix&amp;, vector&lt;double&gt;&amp;)"</span>
00249               &lt;&lt; std::endl
00250               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00251               &lt;&lt; std::endl
00252               &lt;&lt; <span class="stringliteral">"Make sure that B matrix is a symmetric-definite."</span>
00253               &lt;&lt; std::endl;
00254   }
00255   <span class="keywordflow">return</span> INFO;
00256 }
00257 
00258 <span class="comment">//=============================================================================</span><span class="comment"></span>
00259 <span class="comment">/*! calculate generalized eigenvalues\n</span>
00260 <span class="comment">  w is overwitten and become generalized eigenvalues.</span>
00261 <span class="comment">  This matrix and matB are also overwritten. </span>
00262 <span class="comment">*/</span>
<a name="l00263"></a><a class="code" href="classdsymatrix.html#a28">00263</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdsymatrix.html#a27">dsymatrix::dsygv</a>(<a class="code" href="classdsymatrix.html">dsymatrix</a>&amp; matB, std::vector&lt;double&gt;&amp; w,
00264                              std::vector&lt;dcovector&gt;&amp; v)
00265 {
00266 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00267 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dsymatrix::dsygv(dsymatrix&amp;, std::vector&lt;double&gt;&amp;, std::vector&lt;dcovector&gt;&amp;)"</span>
00268             &lt;&lt; std::endl;
00269 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00270 <span class="preprocessor"></span>  
00271 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00272 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(matB.N!=<a class="code" href="classdsymatrix.html#r0">N</a>){
00273     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dsymatrix::dsygv"</span>
00274               &lt;&lt; <span class="stringliteral">"(dsymatrix&amp;, vector&lt;double&gt;&amp;) "</span> &lt;&lt; std::endl
00275               &lt;&lt; <span class="stringliteral">"The matrix B is not a matrix "</span>
00276               &lt;&lt; <span class="stringliteral">"having the same size as \"this\" matrix."</span> &lt;&lt; std::endl
00277               &lt;&lt; <span class="stringliteral">"The B matrix is ("</span> &lt;&lt; matB.N &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.N &lt;&lt; <span class="stringliteral">")."</span>
00278               &lt;&lt; std::endl;
00279     exit(1);
00280   }
00281 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00282 <span class="preprocessor"></span>  
00283   w.resize(<a class="code" href="classdsymatrix.html#r0">N</a>);
00284   v.resize(<a class="code" href="classdsymatrix.html#r0">N</a>);
00285   <span class="keywordtype">char</span> JOBZ(<span class="charliteral">'V'</span>), UPLO(<span class="charliteral">'L'</span>);
00286   <span class="keywordtype">long</span> ITYPE(1), LDA(<a class="code" href="classdsymatrix.html#r0">N</a>), LDB(<a class="code" href="classdsymatrix.html#r0">N</a>), LWORK(-1), INFO(1);
00287   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[1]);
00288   dsygv_(ITYPE, JOBZ, UPLO, <a class="code" href="classdsymatrix.html#r0">N</a>, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, matB.Array, LDB, &amp;w[0],
00289          WORK, LWORK, INFO);
00290   INFO=1;
00291   LWORK = long(WORK[0]);
00292   std::cout &lt;&lt; <span class="stringliteral">" LWORK = "</span>  &lt;&lt; LWORK  &lt;&lt;std::endl;
00293   <span class="keyword">delete</span> [] WORK;  WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK];
00294   dsygv_(ITYPE, JOBZ, UPLO, <a class="code" href="classdsymatrix.html#r0">N</a>, <a class="code" href="classdsymatrix.html#r1">Array</a>, LDA, matB.Array, LDB, &amp;w[0],
00295          WORK, LWORK, INFO);
00296   <span class="keyword">delete</span> [] WORK;
00297   <span class="comment"></span>
00298 <span class="comment">  //// reforming ////</span>
00299 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="classdsymatrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classdsymatrix.html#r0">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00300     v[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].resize(N);
00301     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;N; j++){
00302       v[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>](j) =<a class="code" href="classdsymatrix.html#r2">Darray</a>[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>][j];
00303     }
00304   }
00305   
00306   <span class="keywordflow">if</span>(INFO!=0){
00307     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dsymatrix::dsygv"</span>
00308               &lt;&lt; <span class="stringliteral">"(dsymatrix&amp;, vector&lt;double&gt;&amp;)"</span>
00309               &lt;&lt; std::endl
00310               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00311               &lt;&lt; std::endl
00312               &lt;&lt; <span class="stringliteral">"Make sure that B matrix is a symmetric-definite."</span>
00313               &lt;&lt; std::endl;
00314   }
00315   <span class="keywordflow">return</span> INFO;
00316 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Mar 25 17:28:24 2005 for CPPLapack by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
