<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CPPLapack: dgematrix-lapack.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a>&nbsp;/&nbsp;<a class="el" href="dir_000017.html">dgematrix-</a></div>
<h1>dgematrix-lapack.hpp</h1><a href="dgematrix-lapack_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">//=============================================================================</span><span class="comment"></span>
00002 <span class="comment">/*! solve A*X=Y using dgesv\n</span>
00003 <span class="comment">  The argument is dgematrix Y. Y is overwritten and become the solution X.</span>
00004 <span class="comment">  A is also overwritten and become P*L*U.</span>
00005 <span class="comment">*/</span>
<a name="l00006"></a><a class="code" href="classdgematrix.html#a25">00006</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a25">dgematrix::dgesv</a>(<a class="code" href="classdgematrix.html">dgematrix</a>&amp; mat)
00007 {
00008 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00009 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgesv(dgematrix&amp;)"</span>
00010             &lt;&lt; std::endl;
00011 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00012 <span class="preprocessor"></span>  
00013 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00014 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=<a class="code" href="classdgematrix.html#r1">N</a> || <a class="code" href="classdgematrix.html#r0">M</a>!=mat.M){
00015     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgesv(dgematrix&amp;) "</span> &lt;&lt; std::endl
00016               &lt;&lt; <span class="stringliteral">"These two matrices cannot be solved."</span> &lt;&lt; std::endl
00017               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00018               &lt;&lt; mat.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; mat.N &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00019     exit(1);
00020   }
00021 <span class="preprocessor">#endif//CPPL_DEBUG </span>
00022 <span class="preprocessor"></span>  
00023   <span class="keywordtype">long</span> NRHS(mat.N), LDA(<a class="code" href="classdgematrix.html#r1">N</a>), *IPIV(<span class="keyword">new</span> <span class="keywordtype">long</span>[<a class="code" href="classdgematrix.html#r1">N</a>]), LDB(mat.M), INFO(1);
00024   dgesv_(N, NRHS, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, IPIV, mat.Array, LDB, INFO);
00025   <span class="keyword">delete</span> [] IPIV;
00026   
00027   <span class="keywordflow">if</span>(INFO!=0){
00028     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgesv(dgematrix&amp;) "</span>
00029               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00030               &lt;&lt; std::endl;
00031   }
00032   <span class="keywordflow">return</span> INFO;
00033 }
00034 
00035 <span class="comment">//=============================================================================</span><span class="comment"></span>
00036 <span class="comment">/*! solve A*x=y using dgesv\n</span>
00037 <span class="comment">  The argument is dcovector y. y is overwritten and become the solution x.</span>
00038 <span class="comment">  A is also overwritten and become P*L*U.</span>
00039 <span class="comment">*/</span>
<a name="l00040"></a><a class="code" href="classdgematrix.html#a26">00040</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a25">dgematrix::dgesv</a>(<a class="code" href="classdcovector.html">dcovector</a>&amp; vec)
00041 {
00042 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00043 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgesv(dcovector&amp;)"</span>
00044             &lt;&lt; std::endl;
00045 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00046 <span class="preprocessor"></span>  
00047 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00048 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=<a class="code" href="classdgematrix.html#r1">N</a> || <a class="code" href="classdgematrix.html#r0">M</a>!=vec.L){
00049     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgesv(dcovector&amp;) "</span> &lt;&lt; std::endl
00050               &lt;&lt; <span class="stringliteral">"These matrix and vector cannot be solved."</span> &lt;&lt; std::endl
00051               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00052               &lt;&lt; vec.L &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00053     exit(1);
00054   }
00055 <span class="preprocessor">#endif//CPPL_DEBUG </span>
00056 <span class="preprocessor"></span>  
00057   <span class="keywordtype">long</span> NRHS(1), LDA(<a class="code" href="classdgematrix.html#r1">N</a>), *IPIV(<span class="keyword">new</span> <span class="keywordtype">long</span>[<a class="code" href="classdgematrix.html#r1">N</a>]), LDB(vec.L), INFO(1);
00058   dgesv_(N, NRHS, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, IPIV, vec.Array, LDB, INFO);
00059   <span class="keyword">delete</span> [] IPIV;
00060   
00061   <span class="keywordflow">if</span>(INFO!=0){
00062     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgesv(dcovector&amp;) "</span>
00063               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00064               &lt;&lt; std::endl;
00065   }
00066   <span class="keywordflow">return</span> INFO;
00067 }
00068 <span class="comment"></span>
00069 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00070 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00071 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00072 <span class="comment"></span>
00073 <span class="comment">//=============================================================================</span><span class="comment"></span>
00074 <span class="comment">/*! solve overdetermined or underdetermined A*X=Y using dgels\n</span>
00075 <span class="comment"> */</span>
<a name="l00076"></a><a class="code" href="classdgematrix.html#a27">00076</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a27">dgematrix::dgels</a>(<a class="code" href="classdgematrix.html">dgematrix</a>&amp; mat)
00077 {
00078 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00079 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgels(dgematrix&amp;)"</span>
00080             &lt;&lt; std::endl;
00081 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00082 <span class="preprocessor"></span>  
00083 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00084 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=mat.M){
00085     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgels(dgematrix&amp;) "</span> &lt;&lt; std::endl
00086               &lt;&lt; <span class="stringliteral">"These two matrices cannot be solved."</span> &lt;&lt; std::endl
00087               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00088               &lt;&lt; mat.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; mat.N &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00089     exit(1);
00090   }
00091 <span class="preprocessor">#endif//CPPL_DEBUG    </span>
00092 <span class="preprocessor"></span>  
00093   <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>&lt;<a class="code" href="classdgematrix.html#r1">N</a>){ <span class="comment">//underdetermined</span>
00094     <a class="code" href="classdgematrix.html">dgematrix</a> tmp(<a class="code" href="classdgematrix.html#r1">N</a>,mat.N);
00095     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;mat.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;mat.N; j++){
00096       tmp(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j) =mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00097     }}
00098     mat.clear();
00099     <a class="code" href="classdgematrix.html#n12">swap</a>(mat,tmp);
00100   }
00101   
00102   <span class="keywordtype">char</span> TRANS(<span class="charliteral">'N'</span>);
00103   <span class="keywordtype">long</span> NRHS(mat.N), LDA(<a class="code" href="classdgematrix.html#r0">M</a>), LDB(mat.M),
00104     LWORK(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>)+max(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>),NRHS)), INFO(1);
00105   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00106   dgels_(TRANS, <a class="code" href="classdgematrix.html#r0">M</a>, <a class="code" href="classdgematrix.html#r1">N</a>, NRHS, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, mat.Array, LDB, WORK, LWORK, INFO);
00107   <span class="keyword">delete</span> [] WORK;
00108   
00109   <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>&gt;<a class="code" href="classdgematrix.html#r1">N</a>){ <span class="comment">//overdetermined</span>
00110     <a class="code" href="classdgematrix.html">dgematrix</a> tmp(<a class="code" href="classdgematrix.html#r1">N</a>,mat.N);
00111     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;tmp.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;tmp.N; j++){
00112       tmp(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j) =mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00113     }}
00114     mat.clear();
00115     <a class="code" href="classdgematrix.html#n12">swap</a>(mat,tmp);
00116   }
00117   
00118   <span class="keywordflow">if</span>(INFO!=0){
00119     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgels(dgematrix&amp;) "</span>
00120               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00121               &lt;&lt; std::endl;
00122   }
00123   <span class="keywordflow">return</span> INFO;
00124 }
00125 
00126 <span class="comment">//=============================================================================</span><span class="comment"></span>
00127 <span class="comment">/*! solve overdetermined or underdetermined A*x=y using dgels\n</span>
00128 <span class="comment"> */</span>
<a name="l00129"></a><a class="code" href="classdgematrix.html#a28">00129</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a27">dgematrix::dgels</a>(<a class="code" href="classdcovector.html">dcovector</a>&amp; vec)
00130 {
00131 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00132 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgels(dcovector&amp;)"</span>
00133             &lt;&lt; std::endl;
00134 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00135 <span class="preprocessor"></span>  
00136 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00137 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=vec.L){
00138     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgels(dcovector&amp;) "</span> &lt;&lt; std::endl
00139               &lt;&lt; <span class="stringliteral">"These matrix and vector cannot be solved."</span> &lt;&lt; std::endl
00140               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00141               &lt;&lt; vec.L &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00142     exit(1);
00143   }
00144 <span class="preprocessor">#endif//CPPL_DEBUG    </span>
00145 <span class="preprocessor"></span>  
00146   <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>&lt;<a class="code" href="classdgematrix.html#r1">N</a>){ <span class="comment">//underdetermined</span>
00147     <a class="code" href="classdcovector.html">dcovector</a> tmp(<a class="code" href="classdgematrix.html#r1">N</a>);
00148     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;vec.L; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ tmp(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)=vec(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>); }
00149     vec.<a class="code" href="classdcovector.html#a12">clear</a>();
00150     <a class="code" href="classdgematrix.html#n12">swap</a>(vec,tmp);
00151   }
00152   
00153   <span class="keywordtype">char</span> TRANS(<span class="charliteral">'N'</span>);
00154   <span class="keywordtype">long</span> NRHS(1), LDA(<a class="code" href="classdgematrix.html#r0">M</a>), LDB(vec.L),
00155     LWORK(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>)+max(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>),NRHS)), INFO(1);
00156   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00157   dgels_(TRANS, <a class="code" href="classdgematrix.html#r0">M</a>, <a class="code" href="classdgematrix.html#r1">N</a>, NRHS, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, vec.Array, LDB, WORK, LWORK, INFO);
00158   <span class="keyword">delete</span> [] WORK;
00159   
00160   <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>&gt;<a class="code" href="classdgematrix.html#r1">N</a>){ <span class="comment">//overdetermined</span>
00161     <a class="code" href="classdcovector.html">dcovector</a> tmp(<a class="code" href="classdgematrix.html#r1">N</a>);
00162     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;tmp.<a class="code" href="classdcovector.html#r0">L</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ tmp(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)=vec(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>); }
00163     vec.<a class="code" href="classdcovector.html#a12">clear</a>();
00164     <a class="code" href="classdgematrix.html#n12">swap</a>(vec,tmp);
00165   }
00166   
00167   <span class="keywordflow">if</span>(INFO!=0){
00168     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgels(dcovector&amp;) "</span>
00169               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00170               &lt;&lt; std::endl;
00171   }
00172   <span class="keywordflow">return</span> INFO;
00173 }
00174 
00175 <span class="comment">//=============================================================================</span><span class="comment"></span>
00176 <span class="comment">/*! solve overdetermined or underdetermined A*X=Y using dgels</span>
00177 <span class="comment">  with the sum of residual squares output\n</span>
00178 <span class="comment">  The residual is set as the columnwise sum of residual squares </span>
00179 <span class="comment">  for overdetermined problems</span>
00180 <span class="comment">  while it is always zero for underdetermined problems.</span>
00181 <span class="comment">*/</span>
<a name="l00182"></a><a class="code" href="classdgematrix.html#a29">00182</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a27">dgematrix::dgels</a>(<a class="code" href="classdgematrix.html">dgematrix</a>&amp; mat, <a class="code" href="classdrovector.html">drovector</a>&amp; residual)
00183 {
00184 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00185 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgels(dgematrix&amp;, drovector&amp;)"</span>
00186             &lt;&lt; std::endl;
00187 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00188 <span class="preprocessor"></span>  
00189 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00190 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=mat.M){
00191     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgels(dgematrix&amp;, drovector&amp;) "</span>
00192               &lt;&lt; std::endl
00193               &lt;&lt; <span class="stringliteral">"These two matrices cannot be solved."</span> &lt;&lt; std::endl
00194               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00195               &lt;&lt; mat.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; mat.N &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00196     exit(1);
00197   }
00198 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00199 <span class="preprocessor"></span>  
00200   residual.<a class="code" href="classdcovector.html#a17">resize</a>(mat.N); residual.<a class="code" href="classdcovector.html#a13">zero</a>();
00201   
00202   <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>&lt;<a class="code" href="classdgematrix.html#r1">N</a>){ <span class="comment">//underdetermined</span>
00203     <a class="code" href="classdgematrix.html">dgematrix</a> tmp(<a class="code" href="classdgematrix.html#r1">N</a>,mat.N);
00204     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;mat.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;mat.N; j++){
00205       tmp(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j) =mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00206     }}
00207     mat.<a class="code" href="classdcovector.html#a12">clear</a>();
00208     <a class="code" href="classdgematrix.html#n12">swap</a>(mat,tmp);
00209   }
00210   
00211   <span class="keywordtype">char</span> TRANS(<span class="charliteral">'N'</span>);
00212   <span class="keywordtype">long</span> NRHS(mat.N), LDA(<a class="code" href="classdgematrix.html#r0">M</a>), LDB(mat.M),
00213     LWORK(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>)+max(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>),NRHS)), INFO(1);
00214   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00215   dgels_(TRANS, <a class="code" href="classdgematrix.html#r0">M</a>, <a class="code" href="classdgematrix.html#r1">N</a>, NRHS, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, mat.Array, LDB, WORK, LWORK, INFO);
00216   <span class="keyword">delete</span> [] WORK;
00217   
00218   <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>&gt;<a class="code" href="classdgematrix.html#r1">N</a>){ <span class="comment">//overdetermined</span>
00219     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;residual.L; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;<a class="code" href="classdgematrix.html#r0">M</a>-<a class="code" href="classdgematrix.html#r1">N</a>; j++){
00220       residual(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) += std::pow(mat(N+j,<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>), 2.0);
00221     }}
00222     
00223     <a class="code" href="classdgematrix.html">dgematrix</a> tmp(<a class="code" href="classdgematrix.html#r1">N</a>,mat.N);
00224     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;tmp.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;tmp.N; j++){
00225       tmp(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j) =mat(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00226     }}
00227     mat.<a class="code" href="classdcovector.html#a12">clear</a>();
00228     <a class="code" href="classdgematrix.html#n12">swap</a>(mat,tmp);
00229   }
00230   
00231   <span class="keywordflow">if</span>(INFO!=0){
00232     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgels(dgematrix&amp;, drovector&amp;) "</span>
00233               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00234               &lt;&lt; std::endl;
00235   }
00236   <span class="keywordflow">return</span> INFO;
00237 }
00238 
00239 <span class="comment">//=============================================================================</span><span class="comment"></span>
00240 <span class="comment">/*! solve overdetermined or underdetermined A*x=y using dgels</span>
00241 <span class="comment">  with the sum of residual squares output\n</span>
00242 <span class="comment">  The residual is set as the sum of residual squares </span>
00243 <span class="comment">  for overdetermined problems</span>
00244 <span class="comment">  while it is always zero for underdetermined problems.</span>
00245 <span class="comment">*/</span>
<a name="l00246"></a><a class="code" href="classdgematrix.html#a30">00246</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a27">dgematrix::dgels</a>(<a class="code" href="classdcovector.html">dcovector</a>&amp; vec, <span class="keywordtype">double</span>&amp; residual)
00247 {
00248 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00249 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgels(dcovector&amp;, double&amp;)"</span>
00250             &lt;&lt; std::endl;
00251 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00252 <span class="preprocessor"></span>  
00253 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00254 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=vec.L){
00255     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgels(dcovector&amp;, double&amp;) "</span> &lt;&lt; std::endl
00256               &lt;&lt; <span class="stringliteral">"These matrix and vector cannot be solved."</span> &lt;&lt; std::endl
00257               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00258               &lt;&lt; vec.<a class="code" href="classdcovector.html#r0">L</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00259     exit(1);
00260   }
00261 <span class="preprocessor">#endif//CPPL_DEBUG    </span>
00262 <span class="preprocessor"></span>  
00263   residual=0.0;
00264   
00265   <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>&lt;<a class="code" href="classdgematrix.html#r1">N</a>){ <span class="comment">//underdetermined</span>
00266     <a class="code" href="classdcovector.html">dcovector</a> tmp(<a class="code" href="classdgematrix.html#r1">N</a>);
00267     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;vec.L; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ tmp(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)=vec(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>); }
00268     vec.<a class="code" href="classdcovector.html#a12">clear</a>();
00269     <a class="code" href="classdgematrix.html#n12">swap</a>(vec,tmp);
00270   }
00271   
00272   <span class="keywordtype">char</span> TRANS(<span class="charliteral">'N'</span>);
00273   <span class="keywordtype">long</span> NRHS(1), LDA(<a class="code" href="classdgematrix.html#r0">M</a>), LDB(vec.L),
00274     LWORK(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>)+max(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>),NRHS)), INFO(1);
00275   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00276   dgels_(TRANS, <a class="code" href="classdgematrix.html#r0">M</a>, <a class="code" href="classdgematrix.html#r1">N</a>, NRHS, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, vec.Array, LDB, WORK, LWORK, INFO);
00277   <span class="keyword">delete</span> [] WORK;
00278   
00279   <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>&gt;<a class="code" href="classdgematrix.html#r1">N</a>){ <span class="comment">//overdetermined</span>
00280     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classdgematrix.html#r0">M</a>-<a class="code" href="classdgematrix.html#r1">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ residual+=std::pow(vec(N+<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>),2.0); }
00281     
00282     <a class="code" href="classdcovector.html">dcovector</a> tmp(N);
00283     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;tmp.<a class="code" href="classdcovector.html#r0">L</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ tmp(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)=vec(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>); }
00284     vec.<a class="code" href="classdcovector.html#a12">clear</a>();
00285     <a class="code" href="classdgematrix.html#n12">swap</a>(vec,tmp);
00286   }
00287   
00288   <span class="keywordflow">if</span>(INFO!=0){
00289     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgels(dcovector&amp;, double&amp;) "</span>
00290               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00291               &lt;&lt; std::endl;
00292   }
00293   <span class="keywordflow">return</span> INFO;
00294 }
00295 <span class="comment"></span>
00296 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00297 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00298 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00299 <span class="comment"></span>
00300 <span class="comment">//=============================================================================</span><span class="comment"></span>
00301 <span class="comment">/*! calculate the least-squares-least-norm solution for overdetermined or </span>
00302 <span class="comment">  underdetermined A*x=y using dgelss\n</span>
00303 <span class="comment">*/</span>
<a name="l00304"></a><a class="code" href="classdgematrix.html#a31">00304</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a31">dgematrix::dgelss</a>(<a class="code" href="classdcovector.html">dcovector</a>&amp; B, <a class="code" href="classdcovector.html">dcovector</a>&amp; S, <span class="keywordtype">long</span>&amp; RANK,
00305                               <span class="keyword">const</span> <span class="keywordtype">double</span> RCOND =-1. )
00306 {
00307 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00308 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgelss(dcovector&amp;, dcovector&amp;, long&amp;, const double)"</span>
00309             &lt;&lt; std::endl;
00310 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00311 <span class="preprocessor"></span>  
00312 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00313 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=B.L){
00314     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgelss"</span>
00315               &lt;&lt; <span class="stringliteral">"(dcovector&amp;, dcovector&amp;, long, double) "</span> &lt;&lt; std::endl
00316               &lt;&lt; <span class="stringliteral">"These matrix and vector cannot be solved."</span> &lt;&lt; std::endl
00317               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00318               &lt;&lt; B.<a class="code" href="classdcovector.html#r0">L</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00319     exit(1);
00320   }
00321 <span class="preprocessor">#endif//CPPL_DEBUG    </span>
00322 <span class="preprocessor"></span>  
00323   <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>&lt;<a class="code" href="classdgematrix.html#r1">N</a>){ <span class="comment">//underdetermined</span>
00324     <a class="code" href="classdcovector.html">dcovector</a> tmp(<a class="code" href="classdgematrix.html#r1">N</a>);
00325     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;B.L; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ tmp(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)=B(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>); }
00326     B.<a class="code" href="classdcovector.html#a12">clear</a>();
00327     <a class="code" href="classdgematrix.html#n12">swap</a>(B,tmp);
00328   }
00329   
00330   S.<a class="code" href="classdcovector.html#a17">resize</a>(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>));
00331   
00332   <span class="keywordtype">long</span> NRHS(1), LDA(<a class="code" href="classdgematrix.html#r0">M</a>), LDB(B.L),
00333     LWORK(3*min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>)+max(max(2*min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>),max(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>)), NRHS)), INFO(1);
00334   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00335   dgelss_(<a class="code" href="classdgematrix.html#r0">M</a>, <a class="code" href="classdgematrix.html#r1">N</a>, NRHS, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, B.Array, LDB, S.Array,
00336           RCOND, RANK, WORK, LWORK, INFO);
00337   <span class="keyword">delete</span> [] WORK;
00338 
00339   <span class="keywordflow">if</span>(INFO!=0){
00340     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgelss"</span>
00341               &lt;&lt; <span class="stringliteral">"(dcovector&amp;, docvector&amp;, long, const double) "</span>
00342               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00343               &lt;&lt; std::endl;
00344   }
00345   <span class="keywordflow">return</span> INFO;
00346 }
00347 
00348 <span class="comment">//=============================================================================</span><span class="comment"></span>
00349 <span class="comment">/*! calculate the least-squares-least-norm solution for overdetermined or </span>
00350 <span class="comment">  underdetermined A*x=y using dgelss\n</span>
00351 <span class="comment">*/</span>
<a name="l00352"></a><a class="code" href="classdgematrix.html#a32">00352</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a31">dgematrix::dgelss</a>(<a class="code" href="classdgematrix.html">dgematrix</a>&amp; B, <a class="code" href="classdcovector.html">dcovector</a>&amp; S, <span class="keywordtype">long</span>&amp; RANK,
00353                               <span class="keyword">const</span> <span class="keywordtype">double</span> RCOND =-1. )
00354 {
00355 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00356 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgelss(dgematrix&amp;, dcovector&amp;, long&amp; const double)"</span>
00357             &lt;&lt; std::endl;
00358 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00359 <span class="preprocessor"></span>  
00360 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00361 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=B.M){
00362     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgelss"</span>
00363               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, dcovector&amp;, long&amp;, const double) "</span> &lt;&lt; std::endl
00364               &lt;&lt; <span class="stringliteral">"These matrix and vector cannot be solved."</span> &lt;&lt; std::endl
00365               &lt;&lt; <span class="stringliteral">"Your input was ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">") and ("</span>
00366               &lt;&lt; B.M &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; B.N  &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00367     exit(1);
00368   }
00369 <span class="preprocessor">#endif//CPPL_DEBUG    </span>
00370 <span class="preprocessor"></span>  
00371   <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>&lt;<a class="code" href="classdgematrix.html#r1">N</a>){ <span class="comment">//underdetermined</span>
00372     <a class="code" href="classdgematrix.html">dgematrix</a> tmp(<a class="code" href="classdgematrix.html#r1">N</a>,B.N);
00373     <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;B.<a class="code" href="class__dgematrix.html#o0">M</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00374       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;B.N; j++){
00375         tmp(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j)=B(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);
00376       }
00377     }
00378     B.<a class="code" href="classdcovector.html#a12">clear</a>();
00379     <a class="code" href="classdgematrix.html#n12">swap</a>(B,tmp);
00380   }
00381   
00382   S.<a class="code" href="classdcovector.html#a17">resize</a>(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>));
00383   
00384   <span class="keywordtype">long</span> NRHS(B.N), LDA(<a class="code" href="classdgematrix.html#r0">M</a>), LDB(B.M),
00385     LWORK(3*min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>)+max(max(2*min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>),max(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>)), NRHS)), INFO(1);
00386   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00387   dgelss_(<a class="code" href="classdgematrix.html#r0">M</a>, <a class="code" href="classdgematrix.html#r1">N</a>, NRHS, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, B.Array, LDB, S.Array,
00388           RCOND, RANK, WORK, LWORK, INFO);
00389   <span class="keyword">delete</span> [] WORK;
00390 
00391   <span class="keywordflow">if</span>(INFO!=0){
00392     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgelss"</span>
00393               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, docvector&amp;, long, const double) "</span>
00394               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00395               &lt;&lt; std::endl;
00396   }
00397   <span class="keywordflow">return</span> INFO;
00398 }
00399 <span class="comment"></span>
00400 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00401 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00402 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00403 <span class="comment"></span><span class="comment">//=============================================================================</span><span class="comment"></span>
00404 <span class="comment">/*! calculate eigenvalues\n</span>
00405 <span class="comment">  All of the arguments need not to be initialized. </span>
00406 <span class="comment">  wr and wi are overwitten and become </span>
00407 <span class="comment">  real and imaginary part of eigenvalues, respectively. </span>
00408 <span class="comment">  This matrix is also overwritten. </span>
00409 <span class="comment">*/</span>
<a name="l00410"></a><a class="code" href="classdgematrix.html#a33">00410</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a33">dgematrix::dgeev</a>(std::vector&lt;double&gt;&amp; wr, std::vector&lt;double&gt;&amp; wi)
00411 {
00412 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00413 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgeev(std::vector&lt;double&gt;&amp;, std::vector&lt;double&gt;&amp;)"</span>
00414             &lt;&lt; std::endl;
00415 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00416 <span class="preprocessor"></span>  
00417 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00418 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=<a class="code" href="classdgematrix.html#r1">N</a>){
00419     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgeev"</span>
00420               &lt;&lt; <span class="stringliteral">"(vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;) "</span> &lt;&lt; std::endl
00421               &lt;&lt; <span class="stringliteral">"This matrix is not a square matrix."</span> &lt;&lt; std::endl
00422               &lt;&lt; <span class="stringliteral">"This matrix is ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00423     exit(1);
00424   }
00425 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00426 <span class="preprocessor"></span>  
00427   wr.<a class="code" href="classdcovector.html#a17">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); wi.<a class="code" href="classdcovector.html#a17">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>);
00428   <span class="keywordtype">char</span> JOBVL(<span class="charliteral">'N'</span>), JOBVR(<span class="charliteral">'N'</span>);
00429   <span class="keywordtype">long</span> LDA(<a class="code" href="classdgematrix.html#r1">N</a>), LDVL(1), LDVR(1), LWORK(3*<a class="code" href="classdgematrix.html#r1">N</a>), INFO(1);
00430   <span class="keywordtype">double</span> *VL(NULL), *VR(NULL), *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00431   dgeev_(JOBVL, JOBVR, <a class="code" href="classdgematrix.html#r1">N</a>, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, &amp;wr[0], &amp;wi[0], 
00432          VL, LDVL, VR, LDVR, WORK, LWORK, INFO);
00433   <span class="keyword">delete</span> [] WORK; <span class="keyword">delete</span> [] VL; <span class="keyword">delete</span> [] VL;
00434   
00435   <span class="keywordflow">if</span>(INFO!=0){
00436     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgeev"</span>
00437               &lt;&lt; <span class="stringliteral">"(vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;)"</span>
00438               &lt;&lt; std::endl
00439               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00440               &lt;&lt; std::endl;
00441   }
00442   <span class="keywordflow">return</span> INFO;
00443 }
00444 
00445 <span class="comment">//=============================================================================</span><span class="comment"></span>
00446 <span class="comment">/*! calculate right eigenvalues and right eigenvectors\n</span>
00447 <span class="comment">  All of the arguments need not to be initialized. </span>
00448 <span class="comment">  wr, wi, vrr, vri are overwitten and become </span>
00449 <span class="comment">  real and imaginary part of right eigenvalues and right eigenvectors, </span>
00450 <span class="comment">  respectively. </span>
00451 <span class="comment">  This matrix is also overwritten. </span>
00452 <span class="comment">*/</span>
<a name="l00453"></a><a class="code" href="classdgematrix.html#a34">00453</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a33">dgematrix::dgeev</a>(std::vector&lt;double&gt;&amp; wr, std::vector&lt;double&gt;&amp; wi, 
00454                              std::vector&lt;dcovector&gt;&amp; vrr, 
00455                              std::vector&lt;dcovector&gt;&amp; vri)
00456 {
00457 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00458 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgeev(std::vector&lt;double&gt;&amp;, std::vector&lt;double&gt;&amp;, std::vector&lt;dcovector&gt;&amp;, std::vector&lt;dcovector&gt;&amp;)"</span>
00459             &lt;&lt; std::endl;
00460 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00461 <span class="preprocessor"></span>  
00462 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00463 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=<a class="code" href="classdgematrix.html#r1">N</a>){
00464     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgeev"</span>
00465               &lt;&lt; <span class="stringliteral">"(vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;, "</span>
00466               &lt;&lt; <span class="stringliteral">"vector&lt;dcovector&gt;&amp;, vector&lt;dcovector&gt;&amp;) "</span>
00467               &lt;&lt; std::endl
00468               &lt;&lt; <span class="stringliteral">"This matrix is not a square matrix."</span> &lt;&lt; std::endl
00469               &lt;&lt; <span class="stringliteral">"This matrix is ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00470     exit(1);
00471   }
00472 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00473 <span class="preprocessor"></span>  
00474   wr.<a class="code" href="classdcovector.html#a17">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); wi.<a class="code" href="classdcovector.html#a17">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); vrr.<a class="code" href="classdcovector.html#a17">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); vri.<a class="code" href="classdcovector.html#a17">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>);
00475   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classdgematrix.html#r1">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ vrr[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].<a class="code" href="classdcovector.html#a17">resize</a>(N); vri[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].<a class="code" href="classdcovector.html#a17">resize</a>(N); }
00476   <a class="code" href="classdgematrix.html">dgematrix</a> VR(N,N);
00477   <span class="keywordtype">char</span> JOBVL(<span class="charliteral">'N'</span>), JOBVR(<span class="charliteral">'V'</span>);
00478   <span class="keywordtype">long</span> LDA(N), LDVL(1), LDVR(N), LWORK(4*N), INFO(1);
00479   <span class="keywordtype">double</span> *VL(NULL), *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00480   dgeev_(JOBVL, JOBVR, N, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, &amp;wr[0], &amp;wi[0], 
00481          VL, LDVL, VR.<a class="code" href="classdgematrix.html#r2">Array</a>, LDVR, WORK, LWORK, INFO);
00482   <span class="keyword">delete</span> [] WORK; <span class="keyword">delete</span> [] VL;
00483   <span class="comment"></span>
00484 <span class="comment">  //// forming ////</span>
00485 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;N; j++){
00486     <span class="keywordflow">if</span>(fabs(wi[j])&lt;1e-10){
00487       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00488         vrr[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = VR(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vri[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = 0.0;
00489       }
00490     }
00491     <span class="keywordflow">else</span>{
00492       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00493         vrr[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)   = VR(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vri[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)   = VR(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j+1);
00494         vrr[j+1](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = VR(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vri[j+1](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) =-VR(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j+1);
00495       }
00496       j++;
00497     }
00498   }
00499   
00500   <span class="keywordflow">if</span>(INFO!=0){
00501     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgeev"</span>
00502               &lt;&lt; <span class="stringliteral">"(vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;, "</span>
00503               &lt;&lt; <span class="stringliteral">"vector&lt;dcovector&gt;&amp;, vector&lt;dcovector&gt;&amp;) "</span>
00504               &lt;&lt; std::endl
00505               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00506               &lt;&lt; std::endl;
00507   }
00508   <span class="keywordflow">return</span> INFO;
00509 }
00510 
00511 <span class="comment">//=============================================================================</span><span class="comment"></span>
00512 <span class="comment">/*! calculate left eigenvalues and left eigenvectors\n</span>
00513 <span class="comment">  All of the arguments need not to be initialized. </span>
00514 <span class="comment">  wr, wi, vrr, vri are overwitten and become </span>
00515 <span class="comment">  real and imaginary part of left eigenvalues and left eigenvectors, </span>
00516 <span class="comment">  respectively. </span>
00517 <span class="comment">  This matrix is also overwritten. </span>
00518 <span class="comment">*/</span>
<a name="l00519"></a><a class="code" href="classdgematrix.html#a35">00519</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a33">dgematrix::dgeev</a>(std::vector&lt;double&gt;&amp; wr, std::vector&lt;double&gt;&amp; wi, 
00520                              std::vector&lt;drovector&gt;&amp; vlr, 
00521                              std::vector&lt;drovector&gt;&amp; vli)
00522 {
00523 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00524 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgeev(std::vector&lt;double&gt;&amp;, std::vector&lt;double&gt;&amp;, std::vector&lt;drovector&gt;&amp;, std::vector&lt;drovector&gt;&amp;)"</span>
00525             &lt;&lt; std::endl;
00526 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00527 <span class="preprocessor"></span>  
00528 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00529 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=<a class="code" href="classdgematrix.html#r1">N</a>){
00530     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dgeev"</span>
00531               &lt;&lt; <span class="stringliteral">"(vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;, "</span>
00532               &lt;&lt; <span class="stringliteral">"vector&lt;drovector&gt;&amp;, vector&lt;drovector&gt;&amp;) "</span>
00533               &lt;&lt; std::endl
00534               &lt;&lt; <span class="stringliteral">"This matrix is not a square matrix."</span> &lt;&lt; std::endl
00535               &lt;&lt; <span class="stringliteral">"This matrix is ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00536     exit(1);
00537   }
00538 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00539 <span class="preprocessor"></span>  
00540   wr.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); wi.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); vlr.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); vli.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>);
00541   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classdgematrix.html#r1">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ vlr[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].<a class="code" href="classdgematrix.html#a24">resize</a>(N); vli[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].<a class="code" href="classdgematrix.html#a24">resize</a>(N); }
00542   <a class="code" href="classdgematrix.html">dgematrix</a> VL(N,N);
00543   <span class="keywordtype">char</span> JOBVL(<span class="charliteral">'V'</span>), JOBVR(<span class="charliteral">'N'</span>);
00544   <span class="keywordtype">long</span> LDA(N), LDVL(N), LDVR(1), LWORK(4*N), INFO(1);
00545   <span class="keywordtype">double</span> *VR(NULL), *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00546   dgeev_(JOBVL, JOBVR, N, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, &amp;wr[0], &amp;wi[0], 
00547          VL.<a class="code" href="classdgematrix.html#r2">Array</a>, LDVL, VR, LDVR, WORK, LWORK, INFO);
00548   <span class="keyword">delete</span> [] WORK; <span class="keyword">delete</span> [] VR;
00549 <span class="comment"></span>
00550 <span class="comment">  //// forming ////</span>
00551 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;N; j++){
00552     <span class="keywordflow">if</span>(fabs(wi[j])&lt;1e-10){
00553       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00554         vlr[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = VL(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vli[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = 0.0;
00555       }
00556     }
00557     <span class="keywordflow">else</span>{
00558       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00559         vlr[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)   = VL(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vli[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)   =-VL(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j+1);
00560         vlr[j+1](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = VL(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vli[j+1](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = VL(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j+1);
00561       }
00562       j++;
00563     }
00564   }
00565   
00566 
00567   <span class="keywordflow">if</span>(INFO!=0){
00568     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgeev"</span>
00569               &lt;&lt; <span class="stringliteral">"(vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;, "</span>
00570               &lt;&lt; <span class="stringliteral">"vector&lt;drovector&gt;&amp;, vector&lt;drovector&gt;&amp;) "</span>
00571               &lt;&lt; std::endl
00572               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00573               &lt;&lt; std::endl;
00574   }
00575   <span class="keywordflow">return</span> INFO;
00576 }
00577 
00578 
00579 <span class="comment"></span>
00580 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00581 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00582 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00583 <span class="comment"></span>
00584 <span class="comment">//=============================================================================</span><span class="comment"></span>
00585 <span class="comment">/*! calculate generalized eigenvalues\n</span>
00586 <span class="comment">  All of the arguments don't need to be initialized. </span>
00587 <span class="comment">  wr and wi are overwitten and become </span>
00588 <span class="comment">  real and imaginary part of generalized eigenvalues, respectively. </span>
00589 <span class="comment">  This matrix and matB are also overwritten. </span>
00590 <span class="comment">*/</span>
<a name="l00591"></a><a class="code" href="classdgematrix.html#a36">00591</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a36">dgematrix::dggev</a>(<a class="code" href="classdgematrix.html">dgematrix</a>&amp; matB,
00592                              std::vector&lt;double&gt;&amp; wr, std::vector&lt;double&gt;&amp; wi)
00593 {
00594 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00595 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dggev(dgematrix&amp;, std::vector&lt;double&gt;&amp;, std::vector&lt;double&gt;&amp;)"</span>
00596             &lt;&lt; std::endl;
00597 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00598 <span class="preprocessor"></span>  
00599 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00600 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=<a class="code" href="classdgematrix.html#r1">N</a>){
00601     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dggev"</span>
00602               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;) "</span> &lt;&lt; std::endl
00603               &lt;&lt; <span class="stringliteral">"This matrix is not a square matrix."</span> &lt;&lt; std::endl
00604               &lt;&lt; <span class="stringliteral">"This matrix is ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00605     exit(1);
00606   }
00607   <span class="keywordflow">if</span>(matB.M!=<a class="code" href="classdgematrix.html#r1">N</a> || matB.N!=<a class="code" href="classdgematrix.html#r1">N</a>){
00608     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dggev"</span>
00609               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;) "</span> &lt;&lt; std::endl
00610               &lt;&lt; <span class="stringliteral">"The matrix B is not a square matrix "</span>
00611               &lt;&lt; <span class="stringliteral">"having the same size as \"this\" matrix."</span> &lt;&lt; std::endl
00612               &lt;&lt; <span class="stringliteral">"The B matrix is ("</span> &lt;&lt; matB.<a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.<a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span>
00613               &lt;&lt; std::endl;
00614     exit(1);
00615   }
00616 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00617 <span class="preprocessor"></span>  
00618   wr.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); wi.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>);
00619   <span class="keywordtype">char</span> JOBVL(<span class="charliteral">'N'</span>), JOBVR(<span class="charliteral">'N'</span>);
00620   <span class="keywordtype">long</span> LDA(<a class="code" href="classdgematrix.html#r1">N</a>), LDB(<a class="code" href="classdgematrix.html#r1">N</a>), LDVL(1), LDVR(1), LWORK(8*<a class="code" href="classdgematrix.html#r1">N</a>), INFO(1);
00621   <span class="keywordtype">double</span> *BETA(<span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classdgematrix.html#r1">N</a>]), *VL(NULL), *VR(NULL), 
00622     *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00623   dggev_(JOBVL, JOBVR, N, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, matB.Array, LDB, &amp;wr[0], &amp;wi[0], 
00624          BETA, VL, LDVL, VR, LDVR, WORK, LWORK, INFO);
00625   <span class="keyword">delete</span> [] WORK; <span class="keyword">delete</span> [] VL; <span class="keyword">delete</span> [] VR;
00626   <span class="comment"></span>
00627 <span class="comment">  //// reforming ////</span>
00628 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ wr[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>]/=BETA[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>];  wi[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>]/=BETA[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>]; }
00629   <span class="keyword">delete</span> [] BETA; 
00630   
00631   <span class="keywordflow">if</span>(INFO!=0){
00632     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgeev"</span>
00633               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;)"</span>
00634               &lt;&lt; std::endl
00635               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00636               &lt;&lt; std::endl;
00637   }
00638   <span class="keywordflow">return</span> INFO;
00639 }
00640 
00641 <span class="comment">//=============================================================================</span><span class="comment"></span>
00642 <span class="comment">/*! calculate generalized eigenvalues and generalized right eigenvectors\n</span>
00643 <span class="comment">  All of the arguments don't need to be initialized.</span>
00644 <span class="comment">  wr, wi, vrr and vri are overwitten and become </span>
00645 <span class="comment">  real and imaginary part of generalized eigenvalue </span>
00646 <span class="comment">  and generalized right eigenvector, respectively. </span>
00647 <span class="comment">  This matrix and matB are also overwritten.</span>
00648 <span class="comment">*/</span>
<a name="l00649"></a><a class="code" href="classdgematrix.html#a37">00649</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a36">dgematrix::dggev</a>(<a class="code" href="classdgematrix.html">dgematrix</a>&amp; matB, 
00650                              std::vector&lt;double&gt;&amp; wr, std::vector&lt;double&gt;&amp; wi, 
00651                              std::vector&lt;dcovector&gt;&amp; vrr, 
00652                              std::vector&lt;dcovector&gt;&amp; vri)
00653 {
00654 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00655 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dggev(dgematrix&amp;, std::vector&lt;double&gt;&amp;, std::vector&lt;double&gt;&amp;, std::vector&lt;dcovector&gt;&amp;, std::vector&lt;dcovector&gt;&amp;)"</span>
00656             &lt;&lt; std::endl;
00657 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00658 <span class="preprocessor"></span>  
00659 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00660 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=<a class="code" href="classdgematrix.html#r1">N</a>){
00661     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dggev"</span>
00662               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;, "</span>
00663               &lt;&lt; <span class="stringliteral">"vector&lt;dcovector&gt;&amp;, vector&lt;dcovector&gt;&amp;)"</span> &lt;&lt; std::endl
00664               &lt;&lt; <span class="stringliteral">"This matrix is not a square matrix."</span> &lt;&lt; std::endl
00665               &lt;&lt; <span class="stringliteral">"This matrix is ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00666     exit(1);
00667   }
00668   <span class="keywordflow">if</span>(matB.M!=<a class="code" href="classdgematrix.html#r1">N</a> || matB.N!=<a class="code" href="classdgematrix.html#r1">N</a>){
00669     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dggev"</span>
00670               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;, "</span>
00671               &lt;&lt; <span class="stringliteral">"vector&lt;dcovector&gt;&amp;, vector&lt;dcovector&gt;&amp;)"</span> &lt;&lt; std::endl
00672               &lt;&lt; <span class="stringliteral">"The matrix B is not a square matrix "</span>
00673               &lt;&lt; <span class="stringliteral">"having the same size as \"this\" matrix."</span> &lt;&lt; std::endl
00674               &lt;&lt; <span class="stringliteral">"The B matrix is ("</span> &lt;&lt; matB.<a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.<a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span>
00675               &lt;&lt; std::endl;
00676     exit(1);
00677   }
00678 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00679 <span class="preprocessor"></span>  
00680   wr.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); wi.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); vrr.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); vri.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>);
00681   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classdgematrix.html#r1">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ vrr[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].<a class="code" href="classdgematrix.html#a24">resize</a>(N); vri[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].<a class="code" href="classdgematrix.html#a24">resize</a>(N); }
00682   <a class="code" href="classdgematrix.html">dgematrix</a> VR(N,N);
00683   <span class="keywordtype">char</span> JOBVL(<span class="charliteral">'N'</span>), JOBVR(<span class="charliteral">'V'</span>);
00684   <span class="keywordtype">long</span> LDA(N), LDB(N), LDVL(1), LDVR(N), LWORK(8*N), INFO(1);
00685   <span class="keywordtype">double</span> *BETA(<span class="keyword">new</span> <span class="keywordtype">double</span>[N]), *VL(NULL), *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00686   dggev_(JOBVL, JOBVR, N, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, matB.Array, LDB, &amp;wr[0], &amp;wi[0], 
00687          BETA, VL, LDVL, VR.<a class="code" href="classdgematrix.html#r2">Array</a>, LDVR, WORK, LWORK, INFO);
00688   <span class="keyword">delete</span> [] WORK; <span class="keyword">delete</span> [] VL;
00689   <span class="comment"></span>
00690 <span class="comment">  //// reforming ////</span>
00691 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ wr[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>]/=BETA[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>];  wi[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>]/=BETA[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>]; }
00692   <span class="keyword">delete</span> [] BETA; 
00693   <span class="comment"></span>
00694 <span class="comment">  //// forming ////</span>
00695 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;N; j++){
00696     <span class="keywordflow">if</span>(fabs(wi[j])&lt;1e-10){
00697       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00698         vrr[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = VR(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vri[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = 0.0;
00699       }
00700     }
00701     <span class="keywordflow">else</span>{
00702       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00703         vrr[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)   = VR(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vri[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)   = VR(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j+1);
00704         vrr[j+1](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = VR(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vri[j+1](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) =-VR(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j+1);
00705       }
00706       j++;
00707     }
00708   }
00709   
00710   <span class="keywordflow">if</span>(INFO!=0){
00711     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dggev"</span>
00712               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;, "</span>
00713               &lt;&lt; <span class="stringliteral">"vector&lt;dcovector&gt;&amp;, vector&lt;dcovector&gt;&amp;)"</span> &lt;&lt; std::endl
00714               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00715               &lt;&lt; std::endl;
00716   }
00717   <span class="keywordflow">return</span> INFO;
00718 }
00719 
00720 <span class="comment">//=============================================================================</span><span class="comment"></span>
00721 <span class="comment">/*! calculate generalized eigenvalues and generalized left eigenvectors\n</span>
00722 <span class="comment">  All of the arguments don't need to be initialized.</span>
00723 <span class="comment">  wr, wi, vlr and vli are overwitten and become </span>
00724 <span class="comment">  real and imaginary part of generalized eigenvalue </span>
00725 <span class="comment">  and generalized left eigenvector, respectively. </span>
00726 <span class="comment">  This matrix and matB are also overwritten.</span>
00727 <span class="comment">*/</span>
<a name="l00728"></a><a class="code" href="classdgematrix.html#a38">00728</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a36">dgematrix::dggev</a>(<a class="code" href="classdgematrix.html">dgematrix</a>&amp; matB, 
00729                              std::vector&lt;double&gt;&amp; wr, std::vector&lt;double&gt;&amp; wi, 
00730                              std::vector&lt;drovector&gt;&amp; vlr, 
00731                              std::vector&lt;drovector&gt;&amp; vli)
00732 {
00733 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00734 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dggev(dgematrix&amp;, std::vector&lt;double&gt;&amp;, std::vector&lt;double&gt;&amp;, std::vector&lt;drovector&gt;&amp;, std::vector&lt;drovector&gt;&amp;)"</span>
00735             &lt;&lt; std::endl;
00736 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00737 <span class="preprocessor"></span>  
00738 <span class="preprocessor">#ifdef  CPPL_DEBUG</span>
00739 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="classdgematrix.html#r0">M</a>!=<a class="code" href="classdgematrix.html#r1">N</a>){
00740     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dggev"</span>
00741               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;, "</span>
00742               &lt;&lt; <span class="stringliteral">"vector&lt;drovector&gt;&amp;, vector&lt;drovector&gt;&amp;)"</span> &lt;&lt; std::endl
00743               &lt;&lt; <span class="stringliteral">"This matrix is not a square matrix."</span> &lt;&lt; std::endl
00744               &lt;&lt; <span class="stringliteral">"This matrix is ("</span> &lt;&lt; <a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; <a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span> &lt;&lt; std::endl;
00745     exit(1);
00746   }
00747   <span class="keywordflow">if</span>(matB.M!=<a class="code" href="classdgematrix.html#r1">N</a> || matB.N!=<a class="code" href="classdgematrix.html#r1">N</a>){
00748     std::cerr &lt;&lt; <span class="stringliteral">"[ERROR] dgematrix::dggev"</span>
00749               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;, "</span>
00750               &lt;&lt; <span class="stringliteral">"vector&lt;drovector&gt;&amp;, vector&lt;drovector&gt;&amp;)"</span> &lt;&lt; std::endl
00751               &lt;&lt; <span class="stringliteral">"The matrix B is not a square matrix "</span>
00752               &lt;&lt; <span class="stringliteral">"having the same size as \"this\" matrix."</span> &lt;&lt; std::endl
00753               &lt;&lt; <span class="stringliteral">"The B matrix is ("</span> &lt;&lt; matB.<a class="code" href="classdgematrix.html#r0">M</a> &lt;&lt; <span class="stringliteral">"x"</span> &lt;&lt; matB.<a class="code" href="classdgematrix.html#r1">N</a> &lt;&lt; <span class="stringliteral">")."</span>
00754               &lt;&lt; std::endl;
00755     exit(1);
00756   }
00757 <span class="preprocessor">#endif//CPPL_DEBUG</span>
00758 <span class="preprocessor"></span>  
00759   wr.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); wi.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); vlr.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>); vli.<a class="code" href="classdgematrix.html#a24">resize</a>(<a class="code" href="classdgematrix.html#r1">N</a>);
00760   <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#n15">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;<a class="code" href="classdgematrix.html#r1">N</a>; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ vlr[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].<a class="code" href="classdgematrix.html#a24">resize</a>(N); vli[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>].<a class="code" href="classdgematrix.html#a24">resize</a>(N); }
00761   <a class="code" href="classdgematrix.html">dgematrix</a> VL(N,N);
00762   <span class="keywordtype">char</span> JOBVL(<span class="charliteral">'V'</span>), JOBVR(<span class="charliteral">'N'</span>);
00763   <span class="keywordtype">long</span> LDA(N), LDB(N), LDVL(N), LDVR(1), LWORK(8*N), INFO(1);
00764   <span class="keywordtype">double</span> *BETA(<span class="keyword">new</span> <span class="keywordtype">double</span>[N]), *VR(NULL), *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00765   dggev_(JOBVL, JOBVR, N, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, matB.Array, LDB, &amp;wr[0], &amp;wi[0], 
00766          BETA, VL.<a class="code" href="classdgematrix.html#r2">Array</a>, LDVL, VR, LDVR, WORK, LWORK, INFO);
00767   <span class="keyword">delete</span> [] WORK; <span class="keyword">delete</span> [] VR;
00768   <span class="comment"></span>
00769 <span class="comment">  //// reforming ////</span>
00770 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){ wr[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>]/=BETA[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>];  wi[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>]/=BETA[<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>]; }
00771   <span class="keyword">delete</span> [] BETA; 
00772   <span class="comment"></span>
00773 <span class="comment">  //// forming ////</span>
00774 <span class="comment"></span>  <span class="keywordflow">for</span>(<span class="keywordtype">long</span> j=0; j&lt;N; j++){
00775     <span class="keywordflow">if</span>(fabs(wi[j])&lt;1e-10){
00776       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00777         vlr[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = VL(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vli[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = 0.0;
00778       }
00779     }
00780     <span class="keywordflow">else</span>{
00781       <span class="keywordflow">for</span>(<span class="keywordtype">long</span> <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>=0; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>&lt;N; <a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>++){
00782         vlr[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)   = VL(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vli[j](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>)   =-VL(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j+1);
00783         vlr[j+1](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = VL(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j);  vli[j+1](<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>) = VL(<a class="code" href="__dgbmatrix-calc_8hpp.html#a1">i</a>,j+1);
00784       }
00785       j++;
00786     }
00787   }
00788   
00789   <span class="keywordflow">if</span>(INFO!=0){
00790     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dggev"</span>
00791               &lt;&lt; <span class="stringliteral">"(dgematrix&amp;, vector&lt;double&gt;&amp;, vector&lt;double&gt;&amp;, "</span>
00792               &lt;&lt; <span class="stringliteral">"vector&lt;drovector&gt;&amp;, vector&lt;drovector&gt;&amp;)"</span> &lt;&lt; std::endl
00793               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00794               &lt;&lt; std::endl;
00795   }
00796   <span class="keywordflow">return</span> INFO;
00797 }
00798 <span class="comment"></span>
00799 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00800 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00801 <span class="comment">///////////////////////////////////////////////////////////////////////////////</span>
00802 <span class="comment"></span>
00803 <span class="comment">//=============================================================================</span><span class="comment"></span>
00804 <span class="comment">/*! compute the singular value decomposition (SVD)\n</span>
00805 <span class="comment">  The arguments are dcocector S, dgematrix U and VT.</span>
00806 <span class="comment">  All of them need not to be initialized.</span>
00807 <span class="comment">  S, U and VT are overwitten and become singular values, </span>
00808 <span class="comment">  left singular vectors,</span>
00809 <span class="comment">  and right singular vectors respectively.</span>
00810 <span class="comment">  This matrix also overwritten.</span>
00811 <span class="comment">*/</span>
<a name="l00812"></a><a class="code" href="classdgematrix.html#a39">00812</a> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="classdgematrix.html#a39">dgematrix::dgesvd</a>(<a class="code" href="classdcovector.html">dcovector</a>&amp; S, <a class="code" href="classdgematrix.html">dgematrix</a>&amp; U, <a class="code" href="classdgematrix.html">dgematrix</a>&amp; VT)
00813 {
00814 <span class="preprocessor">#ifdef  CPPL_VERBOSE</span>
00815 <span class="preprocessor"></span>  std::cerr &lt;&lt; <span class="stringliteral">"# [MARK] dgematrix::dgesvd(dcovector&amp;, dgematrix&amp;, dgematrix&amp;)"</span>
00816             &lt;&lt; std::endl;
00817 <span class="preprocessor">#endif//CPPL_VERBOSE</span>
00818 <span class="preprocessor"></span>  
00819   <span class="keywordtype">char</span> JOBU(<span class="charliteral">'A'</span>), JOBVT(<span class="charliteral">'A'</span>);
00820   <span class="keywordtype">long</span> LDA(<a class="code" href="classdgematrix.html#r0">M</a>), LDU(<a class="code" href="classdgematrix.html#r0">M</a>), LDVT(<a class="code" href="classdgematrix.html#r1">N</a>),
00821     LWORK(max(3*min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>)+max(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>),5*min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>))), INFO(1);
00822   <span class="keywordtype">double</span> *WORK(<span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK]);
00823   S.<a class="code" href="classdgematrix.html#a24">resize</a>(min(<a class="code" href="classdgematrix.html#r0">M</a>,<a class="code" href="classdgematrix.html#r1">N</a>)); U.<a class="code" href="classdgematrix.html#a24">resize</a>(LDU,<a class="code" href="classdgematrix.html#r0">M</a>); VT.<a class="code" href="classdgematrix.html#a24">resize</a>(LDVT,<a class="code" href="classdgematrix.html#r1">N</a>);
00824   
00825   dgesvd_(JOBU, JOBVT, <a class="code" href="classdgematrix.html#r0">M</a>, <a class="code" href="classdgematrix.html#r1">N</a>, <a class="code" href="classdgematrix.html#r2">Array</a>, LDA, S.Array, U.Array,
00826           LDU, VT.Array, LDVT, WORK, LWORK, INFO);
00827   <span class="keyword">delete</span> [] WORK;
00828   
00829   <span class="keywordflow">if</span>(INFO!=0){
00830     std::cerr &lt;&lt; <span class="stringliteral">"[WARNING] dgematrix::dgesvd"</span>
00831               &lt;&lt; <span class="stringliteral">"(dceovector&amp;, dgematrix&amp;, dcovector&amp;) "</span>
00832               &lt;&lt; <span class="stringliteral">"Serious trouble happend. INFO = "</span> &lt;&lt; INFO &lt;&lt; <span class="stringliteral">"."</span>
00833               &lt;&lt; std::endl;
00834   }
00835   <span class="keywordflow">return</span> INFO;
00836 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Mar 25 17:28:23 2005 for CPPLapack by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
